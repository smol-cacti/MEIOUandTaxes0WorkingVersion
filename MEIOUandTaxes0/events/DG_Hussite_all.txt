namespace = dg_hussite
#34 of 34 events finished
#Code optimized
#Custom tooltips added

############
# Lollardy # 00s and 10s
############

#01 - Criticism of the Catholic Church (1373) [1-3 provinces]
#02 - Papal Bull against Lollardy (1377) [0-1 provinces]
#03 - Lollard Revolt (1381) [1-2 provinces]
#04 - Council of Blackfriars (1382) [0-2 provinces]
#05 - Heresy at $PROVINCECAPITAL$ (1382) [1 province]
#06 - The Lollard Bible (1384) [1-2 provinces]
#07 - Lollard Petition (1395/1401)
#08 - Lollard Knights (1413)
#09 - Lollardy spreads to $COUNTRY$ (1403)
#10 - The Lollard Council (1414)
#16 - Secret Lollards (ahistorical)
#17 - The Lollard Chancellor (ahistorical)

############
# Hussites # 10s
############

#11 - Martyrdom and Heresy (1415)
#12 - The Hussite League (1415-16)
#13 - Papal Legate arrives (1418)
#14 - The defenestration of $CAPITAL_CITY$ (1419) (historical - ruler dies)
#15 - The defenestration of $CAPITAL_CITY$ (1419) (ahistorical - ruler killed)
#18 - Massacre at $PROVINCECAPITAL$ (ahistorical - strong ruler)

#19* - Heresy at the Council (1415)
#20* - The $PRIMARYCULTURE$ heresy (ahistorical - Hus is allowed to live)

################
# Hussite Wars # 20s and 30s
################

#21 - The Four Articles of $CAPITAL_CITY$ (1420)
#22 - The Community of Tabor (1420)
#23 - Hussite Confederation (~1420)
#24 - The Crown of $COUNTRY$ (1422)
#25 - The Hussite Crown (1422)
#26 - The Hussite Crown (1422)
#27 - Foreign Intervention (1422)
#28 - International Pressure (1423)
#29 - Civil War (1423)
#30 - Hussite Offensive (1427)
#31 - Hussite Raids (1427)
#32 - Noble Turncoats (1432)
#33 - The Assembly of $CAPITAL_CITY$ (1433)

################
# Later Events # 50s
################

#51 - Compact with the Hussites (1462)
#52 - Compacta Voided (1471)
#53 - Long Lost Brethren
#54 - Calixtine Factions



############
# Lollardy #
############

province_event = { #Criticism of the Catholic Church (1373)
	
	id = dg_hussite.001
	title = dg_hussite.001.t
	desc = dg_hussite.001.d
	picture = protestant_preacher
	
	trigger = {
		culture = english
		university_province_trigger = yes
		NOT = { has_global_flag = lollard_criticism }
		is_year = 1370
		NOT = { is_religion_enabled = hussite }
	}
	
	mean_time_to_happen = { months = 50 }
	
	immediate = {
		hidden_effect = {
			set_province_flag = lollard_origins
			change_variable = { which = lollard_supporters value = 2 }
			set_global_flag = lollard_criticism
		}
	}
	
	option = {
		name = dg_hussite.001.a #Support this cause
		ai_chance = {
			factor = 25
			modifier = {
				owner = { has_country_flag = simony }
				factor = 2
			}
			modifier = {
				owner = { has_country_flag = absenteeism }
				factor = 2
			}
			modifier = {
				owner = { has_country_flag = papal_interference }
				factor = 2
			}
			modifier = {
				owner = { has_country_flag = canonical_court_scandal }
				factor = 2
			}
			modifier = {
				owner = { has_country_flag = indulgences_condemned }
				factor = 2
			}
			modifier = {
				owner = { patriarch_authority = 0.60 }
				factor = 2
			}
			modifier = {
				owner = { patriarch_authority = 0.80 }
				factor = 2
			}
			modifier = {
				owner = { NOT = { patriarch_authority = 0.40 } }
				factor = 0.5
			}
			modifier = {
				owner = { NOT = { patriarch_authority = 0.20 } }
				factor = 0.5
			}
			modifier = {
				owner = { at_war_with_religious_enemy = yes }
				factor = 0.5
			}
			modifier = {
				owner = { is_papal_controller = yes }
				factor = 0.5
			}
			modifier = {
				PAP = { has_country_flag = reformer_pope }
				factor = 0.5
			}
			modifier = {
				PAP = { has_country_flag = corrupt_pope }
				factor = 2
			}
		}
		owner = {
			add_country_modifier = { name = nobility_support duration = 1000 }
			add_legitimacy = 2
			add_prestige = 2
			add_papal_influence = -4
			hidden_effect = {
				set_country_flag = lollard_sympathy
				set_country_flag = lollard_preacher
			}
			add_opinion = { who = PAP modifier = papacy_bad }
			every_owned_province = {
				limit = { check_variable = { which = lollard_supporters value = 1 } }
				hidden_effect = { change_variable = { which = lollard_supporters value = 1 } }
				custom_tooltip = followers_increase_small
			}
		}
		hidden_effect = { owner = { country_event = { id = dg_hussite.002 days = 1000 } } }
		random_neighbor_province = {
			limit = { culture = ROOT }
			hidden_effect = { change_variable = { which = lollard_supporters value = 2 } }
			custom_tooltip = followers_increase_small
		}
		hidden_effect = {
			random_neighbor_province = {
				limit = {
					culture = ROOT
					NOT = { check_variable = { which = lollard_supporters value = 1 } }
				}
				change_variable = { which = lollard_supporters value = 2 }
			}
		}
	}
	option = {
		name = dg_hussite.001.b #Let him speak
		ai_chance = { factor = 50 }
		hidden_effect = { owner = { country_event = { id = dg_hussite.002 days = 2000 } } }
		owner = {
			hidden_effect = { set_country_flag = lollard_preacher }
		}
		random_neighbor_province = {
			limit = { culture = ROOT }
			hidden_effect = { change_variable = { which = lollard_supporters value = 2 } }
			custom_tooltip = followers_increase_small
		}
	}
	option = {
		name = dg_hussite.001.c #Silence him
		ai_chance = {
			factor = 25
			modifier = {
				owner = { has_country_flag = simony }
				factor = 0.5
			}
			modifier = {
				owner = { has_country_flag = absenteeism }
				factor = 0.5
			}
			modifier = {
				owner = { has_country_flag = papal_interference }
				factor = 0.5
			}
			modifier = {
				owner = { has_country_flag = canonical_court_scandal }
				factor = 0.5
			}
			modifier = {
				owner = { has_country_flag = indulgences_condemned }
				factor = 0.5
			}
			modifier = {
				owner = { patriarch_authority = 0.60 }
				factor = 0.5
			}
			modifier = {
				owner = { patriarch_authority = 0.80 }
				factor = 0.5
			}
			modifier = {
				owner = { NOT = { patriarch_authority = 0.40 } }
				factor = 2
			}
			modifier = {
				owner = { NOT = { patriarch_authority = 0.20 } }
				factor = 2
			}
			modifier = {
				owner = { at_war_with_religious_enemy = yes }
				factor = 2
			}
			modifier = {
				owner = { is_papal_controller = yes }
				factor = 2
			}
			modifier = {
				PAP = { has_country_flag = reformer_pope }
				factor = 2
			}
			modifier = {
				PAP = { has_country_flag = corrupt_pope }
				factor = 0.5
			}
		}
		owner = {
			hidden_effect = { set_country_flag = lollard_persecution }
			add_legitimacy = -2
			add_prestige = -2
			add_papal_influence = 4
			add_opinion = { who = PAP modifier = papacy_good }
		}
	}
}

country_event = { #Papal Bull against Lollardy (1377)
	
	id = dg_hussite.002
	title = dg_hussite.002.t
	desc = dg_hussite.002.d
	picture = catholic_papal_legate
	
	is_triggered_only = yes
	
	option = {
		name = dg_hussite.002.a #Place him under our protection
		ai_chance = {
			factor = 50
			modifier = {
				has_country_flag = lollard_sympathy
				factor = 2
			}
			modifier = {
				has_country_flag = lollard_revolt
				factor = 0.5
			}
			modifier = {
				has_country_flag = lollard_persecution
				factor = 0.5
			}
			modifier = {
				has_country_flag = simony
				factor = 1.4
			}
			modifier = {
				has_country_flag = absenteeism
				factor = 1.4
			}
			modifier = {
				has_country_flag = papal_interference
				factor = 1.4
			}
			modifier = {
				has_country_flag = canonical_court_scandal
				factor = 1.4
			}
			modifier = {
				has_country_flag = indulgences_condemned
				factor = 1.4
			}
			modifier = {
				patriarch_authority = 0.60
				factor = 1.4
			}
			modifier = {
				patriarch_authority = 0.80
				factor = 1.4
			}
			modifier = {
				NOT = { patriarch_authority = 0.40 }
				factor = 0.7
			}
			modifier = {
				NOT = { patriarch_authority = 0.20 }
				factor = 0.7
			}
			modifier = {
				at_war_with_religious_enemy = yes
				factor = 0.7
			}
			modifier = {
				is_papal_controller = yes
				factor = 0.7
			}
			modifier = {
				PAP = { has_country_flag = reformer_pope }
				factor = 0.7
			}
			modifier = {
				PAP = { has_country_flag = corrupt_pope }
				factor = 1.4
			}
		}
		add_papal_influence = -4
		add_legitimacy = 2
		add_prestige = 2
		add_country_modifier = { name = nobility_support duration = 2000 }
		hidden_effect = {
			clr_country_flag = lollard_persecution
			set_country_flag = lollard_sympathy
			every_owned_province = {
				limit = { check_variable = { which = lollard_supporters value = 1 } }
				change_variable = { which = lollard_supporters value = 1 }
			}
		}
		random_owned_province = {
			limit = {
				has_owner_culture = yes
				NOT = { check_variable = { which = lollard_supporters value = 1 } }
				any_neighbor_province = { check_variable = { which = lollard_supporters value = 1 } }
			}
			hidden_effect = { change_variable = { which = lollard_supporters value = 2 } }
			custom_tooltip = followers_increase_small
		}
	}
	option = {
		name = dg_hussite.002.b #Place him under house arrest
		ai_chance = { factor = 50 }
		if = {
			limit = { NOT = { has_country_flag = council_of_blackfriars } }
			set_country_flag = council_of_blackfriars
			country_event = { id = dg_hussite.004 days = 250 }
		}
		hidden_effect = { PAP = { change_variable = { which = lollard_heresy value = 1 } } }
		add_legitimacy = -2
		add_prestige = -2
		add_papal_influence = 4
		hidden_effect = {
			set_country_flag = lollard_persecution
			clr_country_flag = lollard_sympathy
		}
	}
}

country_event = { #Lollard Revolt (1381)
	
	id = dg_hussite.003
	title = dg_hussite.003.t
	desc = dg_hussite.003.d
	picture = all_massacre
	
	trigger = {
		any_owned_province = { check_variable = { which = lollard_supporters value = 1 } }
		NOT = { has_global_flag = lollard_revolt }
		OR = {
			war_exhaustion = 4
			has_wartaxes = yes
			num_of_rebel_controlled_provinces = 1
			NOT = { manpower_percentage = 0.60 }
		}
		religion_group = christian
		NOT = { religion = hussite }
		NOT = { is_religion_enabled = hussite }
	}
	
	mean_time_to_happen = {
		
		months = 50
		
		modifier = {
			has_regency = yes
			factor = 0.5
		}
		modifier = {
			NOT = {
				num_of_owned_provinces_with = {
					check_variable = { which = lollard_supporters value = 2 }
					value = 3
				}
			}
			factor = 2
		}
	}
	
	immediate = {
		set_global_flag = lollard_revolt
		clr_country_flag = clerical_advisor
		clr_country_flag = patriarch_zealous
		clr_country_flag = patriarch_theologian
		clr_country_flag = patriarch_obedient
		clr_country_flag = patriarch_controversial
		clr_country_flag = patriarch_corrupt
		clr_country_flag = patriarch_hostile
		set_country_flag = patriarch_appointed
		hidden_effect = { PAP = { change_variable = { which = lollard_heresy value = 1 } } }
		every_owned_province = {
			limit = { check_variable = { which = lollard_supporters value = 4 } }
			add_province_modifier = {
				name = "fanatics_organizing"
				duration = 1825
			}
			hidden_effect = {
				set_variable = { which = added_unrest value = 5 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_5
		}
		every_owned_province = {
			limit = {
				check_variable = { which = lollard_supporters value = 1 }
				NOT = { check_variable = { which = lollard_supporters value = 4 } }
			}
			add_province_modifier = {
				name = "peasants_organizing"
				duration = 1825
			}
			hidden_effect = {
				set_variable = { which = added_unrest value = 5 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_5
		}
		hidden_effect = {
			random_owned_province = {
				limit = {
					culture = ROOT
					NOT = { check_variable = { which = lollard_supporters value = 1 } }
					any_neighbor_province = { check_variable = { which = lollard_supporters value = 1 } }
				}
				change_variable = { which = lollard_supporters value = 2 }
			}
		}
	}
	
	option = {
		name = dg_hussite.003.a #It is time to do something about this
		ai_chance = {
			factor = 90
			modifier = {
				has_country_flag = lollard_sympathy
				factor = 0.7
			}
			modifier = {
				has_country_flag = lollard_persecution
				factor = 1.4
			}
		}
		if = {
			limit = { NOT = { has_country_flag = council_of_blackfriars } }
			set_country_flag = council_of_blackfriars
			country_event = { id = dg_hussite.004 days = 250 }
		}
	}
	option = {
		name = dg_hussite.003.b #Let us not be too hasty
		ai_chance = { factor = 10 }
		add_legitimacy = -4
		random_owned_province = {
			limit = {
				has_owner_culture = yes
				NOT = { check_variable = { which = lollard_supporters value = 1 } }
				any_neighbor_province = { check_variable = { which = lollard_supporters value = 1 } }
			}
			custom_tooltip = followers_increase_small
			hidden_effect = { change_variable = { which = lollard_supporters value = 2 } }
		}
	}
	after = {
		dg_patriarch_triggers = yes
	}
}

country_event = { #Council of Blackfriars (1382)
	
	id = dg_hussite.004
	title = dg_hussite.004.t
	desc = dg_hussite.004.d
	picture = catholic_church_trial
	
	is_triggered_only = yes
	
	option = {
		name = dg_hussite.004.a #Declare Lollardy heretical and burn their leaders at the stake
		ai_chance = {
			factor = 30
			modifier = {
				has_country_flag = excommunicated
				factor = 0
			}
			modifier = {
				has_country_flag = lollard_sympathy
				factor = 0
			}
			modifier = {
				has_country_flag = lollard_persecution
				factor = 2
			}
		}
		subtract_stability_1 = yes
		kill_advisor = theologian
		if = {
			limit = { has_country_flag = lollard_sympathy }
			add_prestige = -4
			add_legitimacy = -4
		}
		every_owned_province = {
			limit = { check_variable = { which = lollard_supporters value = 4 } }
			add_province_modifier = {
				name = "fanatics_organizing"
				duration = 1825
			}
			hidden_effect = {
				set_variable = { which = added_unrest value = 5 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_5
		}
		hidden_effect = {
			clr_country_flag = lollard_preacher
			clr_country_flag = lollard_sympathy
			set_country_flag = lollard_persecution
			every_owned_province = {
				limit = { check_variable = { which = lollard_supporters value = 1 } }
				change_variable = { which = hussite which = lollard_supporters }
				subtract_variable = { which = province_religion which = lollard_supporters }
				set_variable = { which = lollard_supporters value = 0 }
			}
		}
	}
	option = {
		name = dg_hussite.004.b #Declare specific doctrines to be heresy, but not the entire movement
		ai_chance = { factor = 60 }
		remove_advisor = theologian
		random_owned_province = {
			limit = {
				has_owner_culture = yes
				NOT = { check_variable = { which = lollard_supporters value = 1 } }
				any_neighbor_province = { check_variable = { which = lollard_supporters value = 1 } }
			}
			hidden_effect = { change_variable = { which = lollard_supporters value = 2 } }
			custom_tooltip = followers_increase_small
		}
	}
	option = {
		name = dg_hussite.004.c #Declare Lollardy to be misunderstood
		ai_chance = {
			factor = 10
			modifier = {
				has_country_flag = excommunicated
				factor = 2
			}
			modifier = {
				has_country_flag = lollard_sympathy
				factor = 2
			}
			modifier = {
				has_country_flag = lollard_persecution
				factor = 0
			}
		}
		subtract_stability_1 = yes
		if = {
			limit = { has_country_flag = lollard_persecution }
			add_prestige = -5
			add_legitimacy = -5
		}
		every_owned_province = {
			limit = { check_variable = { which = lollard_supporters value = 1 } }
			hidden_effect = { change_variable = { which = lollard_supporters value = 2 } }
			custom_tooltip = followers_increase_small
		}
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_owner_culture = yes
					NOT = { check_variable = { which = lollard_supporters value = 1 } }
					any_neighbor_province = { check_variable = { which = lollard_supporters value = 1 } }
				}
				change_variable = { which = lollard_supporters value = 2 }
			}
			random_owned_province = {
				limit = {
					has_owner_culture = yes
					NOT = { check_variable = { which = lollard_supporters value = 1 } }
					any_neighbor_province = { check_variable = { which = lollard_supporters value = 1 } }
				}
				change_variable = { which = lollard_supporters value = 2 }
			}
			set_country_flag = excommunication_usurp_church
			set_country_flag = lollard_sympathy
			clr_country_flag = lollard_persecution
		}
		if = {
			limit = { patriarch_authority = 0.80 }
			add_country_modifier = { name = unhappy_church_powerful duration = 500 }
		}
		else_if = {
			limit = { patriarch_authority = 0.60 }
			add_country_modifier = { name = unhappy_church_strong duration = 500 }
		}
		else_if = {
			limit = { patriarch_authority = 0.40 }
			add_country_modifier = { name = unhappy_church_moderate duration = 500 }
		}
		else_if = {
			limit = { patriarch_authority = 0.20 }
			add_country_modifier = { name = unhappy_church_weak duration = 500 }
		}
		else = {
			add_country_modifier = { name = unhappy_church_impotent duration = 500 }
		}
	}
}

province_event = { #Heresy at $PROVINCECAPITAL$ (1382)
	
	id = dg_hussite.005
	title = dg_hussite.005.t
	desc = dg_hussite.005.d
	picture = catholic_heretic_scientist
	
	trigger = {
		OR = {
			has_province_flag = lollard_origins
			has_province_flag = hussite_origins
		}
		NOT = { is_religion_enabled = protestant }
		owner = { religion = catholic }
		owner = { NOT = { has_country_flag = lollard_sympathy } }
		owner = { NOT = { has_country_flag = excommunicated } }
		NOT = { has_province_flag = lollard_university_purge }
	}
	
	mean_time_to_happen = {
		
		months = 50
		
		modifier = {
			factor = 0.5
			has_country_flag = lollard_persecution
		}
	}
	
	immediate = { hidden_effect = { set_province_flag = lollard_university_purge } }
	
	option = {
		name = dg_hussite.005.a #Dismiss him from his post
		ai_chance = {
			factor = 90
			modifier = {
				owner = { has_country_flag = lollard_persecution }
				factor = 2
			}
		}
		hidden_effect = {
			random_neighbor_province = {
				limit = {
					OR = {
						culture = ROOT
						check_variable = { which = lollard_supporters value = 2 }
						check_variable = { which = hussite value = 2 }
					}
				}
				if = {
					limit = { PAP = { has_country_flag = lollardy_banned } }
					change_variable = { which = hussite value = 2 }
					change_variable = { which = province_religion value = -2 }
				}
				else = {
					change_variable = { which = lollard_supporters value = 2 }
				}
			}
		}
		owner = {
			add_prestige = -5
			remove_advisor = theologian
			trigger_switch = {
				on_trigger = has_country_modifier
				unhappy_church_powerful = {
					remove_country_modifier = unhappy_church_powerful
				}
				unhappy_church_strong = {
					remove_country_modifier = unhappy_church_strong
				}
				unhappy_church_moderate = {
					remove_country_modifier = unhappy_church_moderate
				}
				unhappy_church_weak = {
					remove_country_modifier = unhappy_church_weak
				}
				unhappy_church_impotent = {
					remove_country_modifier = unhappy_church_impotent
				}
			}
		}
	}
	option = {
		name = dg_hussite.005.b #Keep him despite the scandal
		ai_chance = { factor = 10 }
		owner = {
			add_papal_influence = -5
			add_legitimacy = -5
		}
		hidden_effect = {
			set_variable = { which = added_unrest value = 2 }
			add_base_unrest = yes
		}
		custom_tooltip = added_unrest_2
		add_province_modifier = { name = religious_scandal_province duration = 2500 }
		custom_tooltip = followers_increase_large
		hidden_effect = {
			if = {
				limit = { PAP = { has_country_flag = lollardy_banned } }
				change_variable = { which = hussite value = 4 }
				change_variable = { which = province_religion value = -4 }
			}
			else = {
				change_variable = { which = lollard_supporters value = 4 }
			}
		}
	}
}

country_event = { #The Lollard Bible (1384)
	
	id = dg_hussite.006
	title = dg_hussite.006.t
	desc = dg_hussite.006.d
	picture = protestant_bible
	
	trigger = {
		has_country_flag = lollard_preacher
		religion = catholic
		NOT = { is_religion_enabled = hussite }
	}
	
	mean_time_to_happen = { years = 8 }
	
	immediate = {
		hidden_effect = {
			PAP = { change_variable = { which = lollard_heresy value = 1 } }
			set_global_flag = lollard_bible
			clr_country_flag = lollard_preacher
			random_owned_province = {
				limit = {
					has_owner_culture = yes
					OR = {
						any_neighbor_province = { check_variable = { which = lollard_supporters value = 2 } }
						check_variable = { which = lollard_supporters value = 4 }
						check_variable = { which = hussite value = 2 }
					}
				}
				if = {
					limit = { PAP = { has_country_flag = lollardy_banned } }
					change_variable = { which = hussite value = 2 }
					change_variable = { which = province_religion value = -2 }
				}
				else = {
					change_variable = { which = lollard_supporters value = 2 }
				}
			}
		}
	}
	
	option = {
		name = dg_hussite.006.a #Condemn it as unauthorized and inaccurate
		trigger = { NOT = { religion = hussite } }
		ai_chance = {
			factor = 60
			modifier = {
				religion = catholic
				has_country_modifier = religious_intolerance
				factor = 2
			}
			modifier = {
				has_country_flag = lollard_sympathy
				factor = 0.5
			}
			modifier = {
				has_country_flag = lollard_persecution
				factor = 2
			}
		}
		add_prestige = 1
		custom_tooltip = followers_increase_small
	}
	option = {
		name = dg_hussite.006.b #Lend our support to this great work
		ai_chance = { factor = 40 }
		add_adm_power = 10
		add_prestige = 5
		add_treasury = -10
		add_papal_influence = -20
		hidden_effect = {
			set_country_flag = local_bible
			every_owned_province = {
				limit = {
					OR = {
						check_variable = { which = lollard_supporters value = 2 }
						check_variable = { which = hussite value = 2 }
					}
				}
				if = {
					limit = { PAP = { has_country_flag = lollardy_banned } }
					change_variable = { which = hussite value = 1 }
					change_variable = { which = province_religion value = -1 }
				}
				else = {
					change_variable = { which = lollard_supporters value = 1 }
				}
			}
		}
		random_owned_province = {
			limit = {
				has_owner_culture = yes
				OR = {
					any_neighbor_province = { check_variable = { which = lollard_supporters value = 2 } }
					check_variable = { which = lollard_supporters value = 4 }
					check_variable = { which = hussite value = 2 }
				}
			}
			hidden_effect = {
				if = {
					limit = { PAP = { has_country_flag = lollardy_banned } }
					change_variable = { which = hussite value = 2 }
					change_variable = { which = province_religion value = -2 }
				}
				else = {
					change_variable = { which = lollard_supporters value = 2 }
				}
			}
			custom_tooltip = followers_increase_large
		}
	}
}

country_event = { #The Lollard Petition (1395-1401)
	
	id = dg_hussite.007
	title = dg_hussite.007.t
	desc = dg_hussite.007.d
	picture = protestant_reformation
	
	trigger = {
		any_owned_province = { has_province_flag = lollard_origins }
		OR = {
			has_global_flag = lollard_revolt
			any_owned_province = { religion = hussite }
			is_religion_enabled = hussite
			is_year = 1400
		}
		NOT = { has_global_flag = lollard_petition }
		NOT = { religion = hussite }
		NOT = { has_country_modifier = heresy_laws }
	}
	
	mean_time_to_happen = { years = 8 }
	
	immediate = {
		hidden_effect = {
			set_global_flag = lollard_petition
			PAP = { change_variable = { which = lollard_heresy value = 1 } }
			regiongroup = {
				region = {
					limit = { check_variable = { which = lollard_supporters value = 1 } }
					change_variable = { which = hussite which = lollard_supporters }
					subtract_variable = { which = province_religion which = lollard_supporters }
					set_variable = { which = lollard_supporters value = 0 }
				}
			}
		}
	}
	
	option = {
		name = dg_hussite.007.a #Introduce the Heresy Act
		ai_chance = {
			factor = 40
			modifier = {
				has_country_flag = lollard_persecution
				factor = 1.4
			}
			modifier = {
				has_country_flag = lollard_sympathy
				factor = 0
			}
		}
		add_country_modifier = { name = heresy_laws duration = -1 }
		trigger_switch = {
			on_trigger = has_country_modifier
			unhappy_church_powerful = {
				remove_country_modifier = unhappy_church_powerful
			}
			unhappy_church_strong = {
				remove_country_modifier = unhappy_church_strong
			}
			unhappy_church_moderate = {
				remove_country_modifier = unhappy_church_moderate
			}
			unhappy_church_weak = {
				remove_country_modifier = unhappy_church_weak
			}
			unhappy_church_impotent = {
				remove_country_modifier = unhappy_church_impotent
			}
		}
		hidden_effect = {
			set_country_flag = lollard_persecution
			clr_country_flag = lollard_sympathy
		}
	}
	option = {
		name = dg_hussite.007.b #Ignore the petition
		ai_chance = { factor = 50 }
		subtract_stability_1 = yes
		add_legitimacy = -4
		add_prestige = -4
	}
	option = {
		name = dg_hussite.007.c #Turn our backs on the church and embrace Lollardy
		ai_chance = {
			factor = 10
			modifier = {
				has_country_flag = excommunicated
				factor = 2
			}
			modifier = {
				NOT = { any_owned_province = { religion = hussite } }
				factor = 0
			}
			modifier = {
				check_variable = { which = hussite_population value = 10 }
				factor = 1.4
			}
			modifier = {
				check_variable = { which = hussite_population value = 20 }
				factor = 1.4
			}
			modifier = {
				check_variable = { which = hussite_population value = 30 }
				factor = 1.4
			}
			modifier = {
				check_variable = { which = hussite_population value = 40 }
				factor = 1.4
			}
			modifier = {
				check_variable = { which = hussite_population value = 50 }
				factor = 1.4
			}
			modifier = {
				check_variable = { which = hussite_population value = 60 }
				factor = 1.4
			}
			modifier = {
				dominant_religion = hussite
				factor = 2
			}
		}
		trigger = { has_country_flag = lollard_sympathy }
		hidden_effect = {
			hidden_effect = { PAP = { change_variable = { which = lollard_heresy value = 2 } } }
			every_owned_province = {
				limit = {
					OR = {
						check_variable = { which = lollard_supporters value = 1 }
						check_variable = { which = hussite value = 1 }
					}
				}
				change_variable = { which = hussite value = 1 }
				change_variable = { which = province_religion value = -1 }
				every_neighbor_province = {
					limit = { owned_by = ROOT has_owner_culture = yes }
					change_variable = { which = hussite value = 2 }
					change_variable = { which = province_religion value = -2 }
				}
			}
		}
		set_country_flag = voluntary_conversion
		if = {
			limit = { NOT = { is_religion_enabled = hussite } }
			custom_tooltip = convert_dangerous_religion
			subtract_stability_1 = yes
		}
		if = {
			limit = { check_variable = { which = hussite_population value = 75 } }
			custom_tooltip = convert_population_75
			add_stability_1 = yes
		}
		else_if = {
			limit = { check_variable = { which = hussite_population value = 50 } }
			custom_tooltip = convert_population_50
		}
		else_if = {
			limit = { check_variable = { which = hussite_population value = 25 } }
			custom_tooltip = convert_population_25
			subtract_stability_1 = yes
		}
		else = {
			custom_tooltip = convert_population_0
			subtract_stability_2 = yes
		}
		if = {
			limit = { patriarch_authority = 0.75 }
			custom_tooltip = convert_church_strong
			subtract_stability_2 = yes
		}
		else_if = {
			limit = { patriarch_authority = 0.50 }
			custom_tooltip = convert_piety_moderate
			subtract_stability_1 = yes
		}
		else_if = {
			limit = { patriarch_authority = 0.25 }
			custom_tooltip = convert_church_weak
		}
		else = {
			custom_tooltip = convert_church_insignificant
		}
		if = {
			limit = { ADM = 5 }
			if = {
				limit = {
					capital_scope = { religion = hussite }
				}
				custom_tooltip = convert_ruler_strong
				add_stability_3 = yes
			}
			else = {
				custom_tooltip = convert_ruler_moderate
				add_stability_2 = yes
			}
		}
		else_if = {
			limit = { ADM = 3 }
			if = {
				limit = {
					capital_scope = { religion = hussite }
				}
				custom_tooltip = convert_ruler_moderate
				add_stability_2 = yes
			}
			else = {
				custom_tooltip = convert_ruler_weak
				add_stability_1 = yes
			}
		}
		else = {
			if = {
				limit = {
					capital_scope = { religion = hussite }
				}
				custom_tooltip = convert_ruler_weak
				add_stability_1 = yes
			}
			else = {
				custom_tooltip = convert_ruler_incompetent
			}
		}
		if = {
			limit = { advisor = theologian }
			custom_tooltip = convert_theologian
			add_stability_1 = yes
		}
		if = {
			limit = { has_country_flag = was_hussite }
			if = {
				limit = {
					check_variable = { which = sympathy_to_old_religion value = 1 }
				}
				custom_tooltip = convert_previous_recent
				add_stability_2 = yes
			}
			else = {
				custom_tooltip = convert_previous_old
				add_stability_1 = yes
			}
		}
		else = {
			if = {
				limit = {
					check_variable = { which = sympathy_to_old_religion value = 1 }
				}
				custom_tooltip = convert_recent
				add_stability_1 = yes
			}
		}
		change_religion = hussite
		force_converted = yes
		add_ruler_modifier = { name = lollard duration = -1 }
		set_country_flag = lollard_faction
	}
}

country_event = { #Lollard Knights (1413)
	
	id = dg_hussite.008
	title = dg_hussite.008.t
	desc = dg_hussite.008.d
	picture = reformed_rebellion
	
	trigger = {
		has_country_flag = lollard_persecution
		any_owned_province = { has_province_flag = lollard_origins }
		OR = {
			num_of_owned_provinces_with = {
				OR = {
					check_variable = { which = lollard_supporters value = 2 }
					check_variable = { which = hussite value = 2 }
				}
				value = 4
			}
			capital_scope = {
				OR = {
					check_variable = { which = lollard_supporters value = 2 }
					check_variable = { which = hussite value = 2 }
				}
			}
			AND = {
				has_global_flag = lollard_bible
				any_owned_province = { has_province_flag = lollard_university_purge }
			}
		}
		NOT = { has_global_flag = lollard_knights }
		NOT = { religion = hussite }
	}
	
	fire_only_once = yes
	
	mean_time_to_happen = { years = 8 }
	
	immediate = {
		set_global_flag = lollard_knights
		every_owned_province = {
			limit = { check_variable = { which = lollard_supporters value = 6 } }
			add_province_modifier = {
				name = "pretender_organizing"
				duration = 1825
			}
			hidden_effect = {
				set_variable = { which = added_unrest value = 5 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_5
		}
		every_owned_province = {
			limit = {
				OR = {
					check_variable = { which = lollard_supporters value = 2 }
					has_province_flag = lollard_origins
				}
				NOT = { check_variable = { which = lollard_supporters value = 6 } }
			}
			add_province_modifier = {
				name = "pretender_organizing"
				duration = 1825
			}
			hidden_effect = {
				set_variable = { which = added_unrest value = 5 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_5
		}
		add_legitimacy = 10
	}
	
	option = {
		name = dg_hussite.008.a #Demand the pope do something about it
		ai_chance = { factor = 90 }
		add_papal_influence = -5
		hidden_effect = { PAP = { change_variable = { which = lollard_heresy value = 1 } } }
	}
	option = {
		name = dg_hussite.008.b #Introduce an inquisition to $COUNTRY$
		trigger = { NOT = { check_variable = { which = inquisition value = 1 } } }
		ai_chance = { factor = 10 }
		custom_tooltip = introduce_inquisition
		hidden_effect = { change_variable = { which = inquisition value = 2 } }
	}
}

province_event = { #Lollardy spreads to $COUNTRY$
	
	id = dg_hussite.009
	title = dg_hussite.009.t
	desc = dg_hussite.009.d
	picture = protestant_reformers
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			PAP = { change_variable = { which = lollard_heresy value = 2 } }
			owner = { set_country_flag = lollard_preacher }
			set_province_flag = hussite_origins
			set_province_flag = hussite_holy_land
			every_neighbor_province = { set_province_flag = hussite_holy_land }
			change_variable = { which = lollard_supporters value = 2 }
			random_neighbor_province = {
				limit = {
					culture = ROOT
					NOT = { check_variable = { which = lollard_supporters value = 2 } }
				}
				change_variable = { which = lollard_supporters value = 2 }
			}
		}
	}
	
	option = {
		name = dg_hussite.009.a #Send them home
		ai_chance = { factor = 80 }
		every_owned_province = {
			limit = {
				culture = ROOT
				NOT = { base_tax = 8 }
			}
			hidden_effect = { change_variable = { which = lollard_supporters value = 2 } }
			custom_tooltip = followers_increase_small
		}
	}
	option = {
		name = dg_hussite.009.b #Let them debate its merits
		ai_chance = { factor = 20 }
		every_owned_province = {
			limit = {
				culture = ROOT
				OR = {
					rich_province_trigger = yes
					is_capital = yes
					university_province_trigger = yes
				}
			}
			hidden_effect = { change_variable = { which = lollard_supporters value = 4 } }
			custom_tooltip = followers_increase_small
		}
	}
}

country_event = { #The Lollard Council (1414)
	
	id = dg_hussite.010
	title = dg_hussite.010.t
	desc = dg_hussite.010.d
	picture = hussite_council
	
	trigger = {
		is_emperor = yes
		NOT = { PAP = { has_country_flag = lollard_safe_passage } }
		PAP = { check_variable = { which = council_topic_lollardy value = 1 } }
		any_province = {
			is_part_of_hre = yes
			OR = {
				has_province_modifier = church_council
				has_province_flag = hussite_origins
			}
		}
	}
	
	mean_time_to_happen = { months = 1 }
	
	immediate = { hidden_effect = { PAP = { set_country_flag = lollard_safe_passage } } }
	
	option = {
		name = dg_hussite.010.a #Promise safe passage
		ai_chance = { factor = 100 }
		add_prestige = 2
		add_legitimacy = 2
		random_known_country = {
			limit = { any_owned_province = { has_province_flag = hussite_origins } }
			add_opinion = { who = ROOT modifier = aided_coreligionists_observant }
		}
		hidden_effect = { set_country_flag = lollard_safe_passage_guarantor }
	}
	option = {
		name = dg_hussite.010.b #We cannot guarantee his safety
		ai_chance = { factor = 0 }
		random_known_country = {
			limit = { any_owned_province = { has_province_flag = hussite_origins } }
			add_opinion = { who = ROOT modifier = council_failed_pious }
		}
		add_prestige = -5
		if = {
			limit = { is_emperor = yes }
			add_imperial_influence = -5
		}
	}
}

country_event = { #16 - Secret Lollards
	
	id = dg_hussite.016
	title = dg_hussite.016.t
	desc = dg_hussite.016.d
	picture = hussite_barons
	
	trigger = {
		religion = hussite
		is_force_converted = yes
		NOT = { has_country_flag = religious_civil_war }
		NOT = { has_country_flag = secret_lollards }
	}
	
	mean_time_to_happen = {
		
		months = 10
		
		modifier = {
			has_country_flag = religious_turmoil_catholic
			factor = 0.5
		}
		modifier = {
			stability = 1
			factor = 0.7
		}
		modifier = {
			stability = 3
			factor = 0.7
		}
		modifier = {
			NOT = { stability = 0 }
			factor = 1.4
		}
		modifier = {
			NOT = { stability = -2 }
			factor = 1.4
		}
	}
	
	immediate = { set_country_flag = secret_lollards }
	
	option = {
		name = dg_hussite.016.a
		custom_tooltip = secret_lollards_explained
		hidden_effect = {
			every_owned_province = {
				limit = {
					religion_group = christian
					culture = capital
				}
				random = {
					chance = 25
					change_variable = { which = hussite value = 4 }
					change_variable = { which = province_religion value = -4 }
				}
			}
			#Minimum 1 province (or 1 super province)
			random_owned_province = {
				limit = {
					religion_group = christian
					culture = capital
				}
				change_variable = { which = hussite value = 4 }
				change_variable = { which = province_religion value = -4 }
			}
			#just in case
			every_owned_province = {
				change_variable = { which = hussite which = lollard_supporters }
				subtract_variable = { which = province_religion which = lollard_supporters }
				set_variable = { which = lollard_supporters value = 0 }
			}
		}
	}
}

country_event = { #17 - the Lollard Chancellor
	
	id = dg_hussite.017
	title = dg_hussite.017.t
	desc = dg_hussite.017.d
	picture = all_powerful_advisor
	
	trigger = {
		has_country_flag = lollard_sympathy
		any_owned_province = { has_province_flag = lollard_origins }
		num_of_owned_provinces_with = {
			OR = {
				check_variable = { which = lollard_supporters value = 2 }
				check_variable = { which = hussite value = 2 }
			}
			value = 4
		}
		NOT = { has_global_flag = lollard_chancellor }
	}
	
	mean_time_to_happen = { years = 8 }
	
	immediate = {
		set_global_flag = lollard_chancellor
		hidden_effect = {
			every_owned_province = {
				limit = { check_variable = { which = lollard_supporters value = 1 } }
				change_variable = { which = hussite which = lollard_supporters }
				subtract_variable = { which = province_religion which = lollard_supporters }
				set_variable = { which = lollard_supporters value = 0 }
			}
		}
	}
	
	option = {
		name = dg_hussite.017.a
		ai_chance = { factor = 70 }
		add_legitimacy = -10
		add_prestige = -20
		remove_advisor = random
		remove_advisor = random
		remove_advisor = random
		hidden_effect = {
			clr_country_flag = lollard_sympathy
			set_country_flag = lollard_persecution
		}
	}
	option = {
		name = dg_hussite.017.b
		ai_chance = {
			factor = 30
			modifier = {
				is_at_war = yes
				factor = 0.7
			}
			modifier = {
				NOT = { manpower_percentage = 0.80 }
				factor = 0.7
			}
			modifier = {
				NOT = { manpower_percentage = 0.60 }
				factor = 0.7
			}
			modifier = {
				NOT = { manpower_percentage = 0.40 }
				factor = 0.7
			}
			modifier = {
				NOT = { manpower_percentage = 0.20 }
				factor = 0.7
			}
			modifier = {
				war_exhaustion = 4
				factor = 0.7
			}
			modifier = {
				war_exhaustion = 8
				factor = 0.7
			}
			modifier = {
				war_exhaustion = 12
				factor = 0.7
			}
			modifier = {
				war_exhaustion = 16
				factor = 0.7
			}
			modifier = {
				num_of_rebel_controlled_provinces = 1
				factor = 0.7
			}
			modifier = {
				num_of_rebel_controlled_provinces = 2
				factor = 0.7
			}
		}
		subtract_stability_2 = yes
		change_religion = hussite
		force_converted = yes
		add_ruler_modifier = { name = lollard duration = -1 }
		set_country_flag = lollard_faction
		hidden_effect = {
			every_owned_province = {
				limit = {
					OR = {
						has_province_flag = lollard_origins
						is_capital = yes
						check_variable = { which = hussite value = 2 }
					}
				}
				change_variable = { which = hussite value = 6 }
				change_variable = { which = province_religion value = -6 }
			}
		}
		set_country_flag = religious_turmoil_catholic
		country_event = { id = dg_turmoil.041 days = 120 }
		hidden_effect = { country_event = { id = dg_hussite.016 days = 30 } }
	}
}

############
# Hussites # 10s
############

country_event = { #Martyrdom and Heresy (1415)
	
	id = dg_hussite.011
	title = dg_hussite.011.t
	desc = dg_hussite.011.d
	picture = protestant_massacre
	
	is_triggered_only = yes #By dg_pope.042
	
	immediate = {
		set_global_flag = dates_of_interest_martyrdom_of_jan_hus_1415
	}
	
	option = {
		name = dg_hussite.011.a #Send a '$PRIMARY_CULTURE$ protestation' to the emperor
		ai_chance = {
			factor = 40
			modifier = {
				any_owned_province = {
					check_variable = { which = hussite value = 2 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				capital_scope = {
					check_variable = { which = hussite value = 2 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				any_owned_province = {
					check_variable = { which = hussite value = 4 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				capital_scope = {
					check_variable = { which = hussite value = 4 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				any_owned_province = {
					check_variable = { which = hussite value = 8 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				capital_scope = {
					check_variable = { which = hussite value = 8 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				any_owned_province = {
					check_variable = { which = hussite value = 12 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				capital_scope = {
					check_variable = { which = hussite value = 12 }
					has_owner_culture = yes
				}
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 100 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 80 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 60 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 40 }
				factor = 1.4
			}
		}
		trigger = {
			NOT = { has_country_flag = lollard_safe_passage_guarantor }
			any_owned_province = { has_province_flag = hussite_origins }
			any_known_country = { has_country_flag = lollard_safe_passage_guarantor }
		}
		custom_tooltip = hussite_10
		add_legitimacy = 5
		custom_tooltip = useful_minority
		hidden_effect = {
			set_variable = { which = minority_usefulness value = 10 }
			set_country_flag = useful_hussite
		}
		every_owned_province = {
			limit = { check_variable = { which = hussite value = 2 } }
			add_province_modifier = { name = religious_scandal_province duration = 1000 }
			hidden_effect = {
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
		}
		random_known_country = {
			limit = { has_country_flag = lollard_safe_passage_guarantor }
			reverse_add_opinion = { who = ROOT modifier = dg_broken_promises }
		}
		add_opinion = { who = FROM modifier = papacy_bad }
		add_opinion = { who = PAP modifier = papacy_bad }
		if = {
			limit = { is_emperor = no }
			add_imperial_influence = -5
		}
	}
	option = {
		name = dg_hussite.011.b #Express our outrage at this result
		ai_chance = {
			factor = 30
			modifier = {
				has_country_flag = lollard_sympathy
				factor = 2
			}
			modifier = {
				has_country_flag = lollard_safe_passage_guarantor
				factor = 0.5
			}
		}
		trigger = {
			OR = {
				NOT = { any_known_country = { has_country_flag = lollard_safe_passage_guarantor } }
				NOT = { any_owned_province = { has_province_flag = hussite_origins } }
			}
		}
		custom_tooltip = hussite_10
		custom_tooltip = useful_minority
		hidden_effect = {
			set_variable = { which = minority_usefulness value = 10 }
			set_country_flag = useful_hussite
		}
		every_owned_province = {
			limit = { check_variable = { which = hussite value = 2 } }
			add_province_modifier = { name = religious_scandal_province duration = 1000 }
			hidden_effect = {
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
		}
		add_opinion = { who = FROM modifier = papacy_bad }
		add_opinion = { who = PAP modifier = papacy_bad }
		if = {
			limit = { is_emperor = yes }
			add_imperial_influence = -10
		}
	}
	option = {
		name = dg_hussite.011.c #Let the mob roam freely
		trigger = { NOT = { religion = hussite } }
		ai_chance = {
			factor = 30
			modifier = {
				has_country_flag = lollard_persecution
				factor = 2
			}
			modifier = {
				NOT = { legitimacy = 100 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 80 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 60 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 40 }
				factor = 0
			}
		}
		subtract_stability_1 = yes
		add_legitimacy = -5
		add_country_modifier = { name = religious_intolerance duration = 1000 }
		every_owned_province = {
			limit = {
				check_variable = { which = hussite value = 2 }
				NOT = { check_variable = { which = hussite value = 4 } }
			}
			add_province_modifier = { name = religious_scandal_province duration = 1000 }
			spawn_rebels = { type = catholic_rebels size = 0 }
		}
		every_owned_province = {
			limit = {
				check_variable = { which = hussite value = 4 }
				NOT = { check_variable = { which = hussite value = 6 } }
			}
			add_province_modifier = { name = religious_scandal_province duration = 1000 }
			hidden_effect = {
				set_variable = { which = added_unrest value = 1 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_1
			spawn_rebels = { type = hussite_rebels size = 0 }
		}
		every_owned_province = {
			limit = { check_variable = { which = hussite value = 6 } }
			add_province_modifier = { name = religious_scandal_province duration = 1000 }
			hidden_effect = {
				set_variable = { which = added_unrest value = 2 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_2
			spawn_rebels = { type = hussite_rebels size = 1 }
		}
	}
}

country_event = { #The Hussite League (1415)
	
	id = dg_hussite.012
	title = dg_hussite.012.t
	desc = dg_hussite.012.d
	picture = hussite_barons
	
	trigger = {
		PAP = { had_country_flag = { flag = lollardy_banned days = 90 } }
		religion_group = christian
		any_owned_province = { has_province_flag = hussite_origins }
		NOT = { is_religion_enabled = hussite }
		NOT = { is_religion_enabled = protestant } #Just in case
		NOT = { has_country_flag = hussite_league_formed }
	}
	
	mean_time_to_happen = {
		
		months = 3
		
		modifier = {
			piety = 0.60
			factor = 0.7
		}
		modifier = {
			piety = 0.20
			factor = 0.7
		}
		modifier = {
			NOT = { piety = -0.20 }
			factor = 1.4
		}
		modifier = {
			NOT = { piety = -0.60 }
			factor = 1.4
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = hussite_league_formed
			capital_scope = {
				change_variable = { which = hussite value = 4 }
				change_variable = { which = province_religion value = -4 }
			}
		}
	}
	
	option = {
		name = dg_hussite.012.a #Try to suppress the Hussites
		ai_chance = {
			factor = 70
			modifier = {
				hussite = 0
				factor = 2
			}
			modifier = {
				NOT = { legitimacy = 100 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 80 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 60 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 40 }
				factor = 0
			}
		}
		add_country_modifier = { name = religious_tolerance duration = 1000 }
		custom_tooltip = hussite_10
		hidden_effect = {
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 2 } }
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
		}
		hidden_effect = { country_event = { id = dg_hussite.013 days = 800 } }
	}
	option = {
		name = dg_hussite.012.b #Support the Hussite League
		ai_chance = {
			factor = 20
			modifier = {
				religion = hussite
				factor = 4
			}
			modifier = {
				NOT = { legitimacy = 100 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 80 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 60 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 40 }
				factor = 0
			}
		}
		set_country_flag = leaning_hussite
		if = {
			limit = { piety = 0.60 }
			add_legitimacy = -4
			add_prestige = -8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_legitimacy = -3
			add_prestige = -6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_legitimacy = -2
			add_prestige = -4
		}
		else_if = {
			limit = { piety = -0.60 }
			add_legitimacy = -1
			add_prestige = -2
		}
		subtract_stability_1 = yes
		custom_tooltip = hussite_20
		custom_tooltip = useful_minority
		hidden_effect = {
			set_variable = { which = minority_usefulness value = 10 }
			set_country_flag = useful_hussite
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 2 } }
				change_variable = { which = hussite value = 4 }
				change_variable = { which = province_religion value = -4 }
			}
		}
		every_owned_province = {
			limit = {
				religion = catholic
				NOT = { check_variable = { which = hussite value = 4 } }
			}
			hidden_effect = {
				set_variable = { which = added_unrest value = 1 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_1
		}
		hidden_effect = { country_event = { id = dg_hussite.013 days = 400 } }
	}
	option = {
		name = dg_hussite.012.c #Support the Romanists
		trigger = { NOT = { religion = hussite } }
		ai_chance = {
			factor = 10
			modifier = {
				NOT = { religion = catholic }
				factor = 0.5
			}
			modifier = {
				NOT = { hussite = -1 }
				factor = 2
			}
			modifier = {
				has_country_modifier = religious_intolerance
				factor = 2
			}
			modifier = {
				NOT = { religious_unity = 0.80 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.60 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.40 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.20 }
				factor = 0
			}
		}
		set_country_flag = leaning_catholic
		if = {
			limit = { piety = 0.60 }
			add_legitimacy = -4
			add_prestige = -8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_legitimacy = -3
			add_prestige = -6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_legitimacy = -2
			add_prestige = -4
		}
		else_if = {
			limit = { piety = -0.60 }
			add_legitimacy = -1
			add_prestige = -2
		}
		if = {
			limit = { check_variable = { which = inquisition value = 1 } }
			add_country_modifier = { name = religious_intolerance duration = 2000 }
		}
		if = {
			limit = { NOT = { check_variable = { which = inquisition value = 1 } } }
			custom_tooltip = introduce_inquisition
			hidden_effect = { change_variable = { which = inquisition value = 1 } }
		}
		subtract_stability_1 = yes
		hidden_effect = {
			set_country_flag = religious_turmoil_happening
			set_country_flag = religious_turmoil_hussite
		}
		capital_scope = { add_province_modifier = { name = expulsion_of_heretics duration = 1500 } }
		every_owned_province = {
			limit = { check_variable = { which = hussite value = 4 } }
			hidden_effect = {
				set_variable = { which = added_unrest value = 1 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_1
		}
	}
}

country_event = { #Papal Legate arrives
	
	id = dg_hussite.013
	title = dg_hussite.013.t
	desc = dg_hussite.013.d
	picture = catholic_papal_legate
	
	is_triggered_only = yes
	
	option = {
		name = dg_hussite.013.a #Agree to persecute the Hussites
		trigger = { NOT = { religion = hussite } }
		ai_chance = { factor = 30 }
		subtract_stability_1 = yes
		set_country_flag = leaning_catholic
		custom_tooltip = introduce_inquisition
		hidden_effect = { change_variable = { which = inquisition value = 1 } }
		clr_country_flag = useful_hussite
	}
	option = {
		name = dg_hussite.013.b #Find ways to delay
		trigger = { NOT = { has_country_flag = hussite_vacillation } }
		ai_chance = { factor = 60 }
		set_country_flag = hussite_vacillation
		add_prestige = -1
		country_event = { id = dg_hussite.013 days = 400 }
		hidden_effect = {
			random_owned_province = {
				limit = { check_variable = { which = hussite value = 2 } NOT = { religion = hussite } }
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
		}
	}
	option = {
		name = dg_hussite.013.c #Expel the legate from $COUNTRY$
		ai_chance = {
			factor = 10
			modifier = {
				NOT = { any_owned_province = { religion = hussite } }
				factor = 0
			}
		}
		add_prestige = 5
		set_country_flag = leaning_hussite
		if = {
			limit = {
				religion = catholic
				NOT = {
					OR = {
						dominant_religion = hussite
						capital_scope = { religion = hussite }
					}
				}
			}
			subtract_stability_1 = yes
			add_legitimacy = -10
		}
		if = {
			limit = {
				religion = catholic
				OR = {
					dominant_religion = hussite
					capital_scope = { religion = hussite }
				}
			}
			set_country_flag = voluntary_conversion
			if = {
				limit = { NOT = { is_religion_enabled = hussite } }
				custom_tooltip = convert_dangerous_religion
				subtract_stability_1 = yes
			}
			if = {
				limit = { check_variable = { which = hussite_population value = 75 } }
				custom_tooltip = convert_population_75
				add_stability_1 = yes
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 50 } }
				custom_tooltip = convert_population_50
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 25 } }
				custom_tooltip = convert_population_25
				subtract_stability_1 = yes
			}
			else = {
				custom_tooltip = convert_population_0
				subtract_stability_2 = yes
			}
			if = {
				limit = { patriarch_authority = 0.75 }
				custom_tooltip = convert_church_strong
				subtract_stability_2 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.50 }
				custom_tooltip = convert_piety_moderate
				subtract_stability_1 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.25 }
				custom_tooltip = convert_church_weak
			}
			else = {
				custom_tooltip = convert_church_insignificant
			}
			if = {
				limit = { ADM = 5 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_strong
					add_stability_3 = yes
				}
				else = {
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
			}
			else_if = {
				limit = { ADM = 3 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
				else = {
					custom_tooltip = convert_ruler_incompetent
				}
			}
			if = {
				limit = { advisor = theologian }
				custom_tooltip = convert_theologian
				add_stability_1 = yes
			}
			if = {
				limit = {
					has_country_flag = was_hussite
				}
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_previous_recent
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_previous_old
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_recent
					add_stability_1 = yes
				}
			}
			change_religion = hussite
			hidden_effect = {
				set_country_flag = internal_crusade
				capital_scope = { set_province_flag = crusade_goal }
				set_country_flag = hussite_wars_target
				PAP = { set_country_flag = hussite_wars }
				regiongroup = {
					region = {
						limit = { check_variable = { which = lollard_supporters value = 1 } }
						change_variable = { which = hussite which = lollard_supporters }
						subtract_variable = { which = province_religion which = lollard_supporters }
						set_variable = { which = lollard_supporters value = 0 }
					}
				}
			}
		}
		hidden_effect = {
			random_owned_province = {
				limit = { check_variable = { which = hussite value = 2 } NOT = { religion = hussite } }
				change_variable = { which = hussite value = 4 }
				change_variable = { which = province_religion value = -4 }
			}
			random_owned_province = {
				limit = { check_variable = { which = hussite value = 2 } NOT = { religion = hussite } }
				change_variable = { which = hussite value = 4 }
				change_variable = { which = province_religion value = -4 }
			}
		}
	}
}

country_event = { #The Defenestration of $CAPITAL_CITY$ (historical version)
	
	id = dg_hussite.014
	title = dg_hussite.014.t
	desc = dg_hussite.014.d
	picture = protestant_defenestration
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = hussite_league_formed
		has_country_flag = leaning_catholic
		PAP = { has_country_flag = lollardy_banned }
		NOT = { PAP = { has_country_flag = hussite_wars } }
		NOT = { is_religion_enabled = protestant }
		NOT = { religion = hussite }
		capital_scope = {
			has_owner_culture = yes
			check_variable = { which = hussite value = 4 }
		}
	}
	
	immediate = {
		set_global_flag = dates_of_interest_defenestration_of_prague_1419
		clr_country_flag = leaning_catholic
		hidden_effect = {
			set_country_flag = hussite_wars_target
			PAP = { set_country_flag = hussite_wars }
			regiongroup = {
				region = {
					limit = { check_variable = { which = lollard_supporters value = 1 } }
					change_variable = { which = hussite which = lollard_supporters }
					subtract_variable = { which = province_religion which = lollard_supporters }
					set_variable = { which = lollard_supporters value = 0 }
				}
			}
		}
		every_country = {
			limit = {
				religion = catholic
				OR = {
					is_neighbor_of = ROOT
					is_elector = yes
					is_emperor = yes
					is_papal_controller = yes
					is_subject_of = ROOT
				}
				NOT = { tag = ROOT }
			}
			add_opinion = { who = ROOT modifier = throneless_king }
		}
		if = {
			limit = { has_heir = yes }
			exile_heir_as = hussite_war_heir
			set_country_flag = hussite_war_heir
		}
		define_heir = { age = 10 dynasty = ROOT }
		define_ruler = {
			regency = yes
			ADM = 0
			DIP = 0
			MIL = 0
		}
		#if = {
		#	limit = { has_country_modifier = edict_of_tolerance }
			remove_country_modifier = edict_of_tolerance
		#}
		add_war_exhaustion = 2
		if = {
			limit = { piety = 0.60 }
			add_country_modifier = { name = religious_intolerance duration = 1600 }
		}
		else_if = {
			limit = { piety = 0.20 }
			add_country_modifier = { name = religious_intolerance duration = 800 }
		}
		else_if = {
			limit = { piety = -0.20 }
			add_country_modifier = { name = religious_intolerance duration = 400 }
		}
		hidden_effect = {
			set_country_flag = war_of_religion_fought
			set_country_flag = religious_civil_war
			every_owned_province = {
				set_variable = { which = religious_uprising value = 0 }
				if = {
					limit = { check_variable = { which = hussite value = 20 } }
					change_variable = { which = religious_uprising value = 7 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 16 } }
					change_variable = { which = religious_uprising value = 6 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 12 } }
					change_variable = { which = religious_uprising value = 5 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 8 } }
					change_variable = { which = religious_uprising value = 4 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 6 } }
					change_variable = { which = religious_uprising value = 3 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 4 } }
					change_variable = { which = religious_uprising value = 2 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 2 } }
					change_variable = { which = religious_uprising value = 1 }
				}
				if = {
					limit = { is_colony = yes }
					change_variable = { which = religious_uprising value = -2 }
				}
				if = { #To avoid wars of religion ending due to forts reconquering them
					limit = { NOT = { fort_level = 1 } }
					multiply_variable = { which = religious_uprising value = 0.5 }
					if = {
						limit = { any_neighbor_province = { owned_by = ROOT fort_level = 1 } }
						multiply_variable = { which = religious_uprising value = 0.5 }
					}
				}
			}
			set_variable = { which = heretic_bastion value = 1 }
			set_variable = { which = church_bastion value = 1 }
			if = {
				limit = { num_of_cities = 50 } #Larger countries get larger uprisings
				change_variable = { which = heretic_bastion value = 4 }
				change_variable = { which = church_bastion value = 4 }
			}
			else_if = {
				limit = { num_of_cities = 25 }
				change_variable = { which = heretic_bastion value = 3 }
				change_variable = { which = church_bastion value = 3 }
			}
			else_if = {
				limit = { num_of_cities = 12 }
				change_variable = { which = heretic_bastion value = 2 }
				change_variable = { which = church_bastion value = 2 }
			}
			else_if = {
				limit = { num_of_cities = 8 }
				change_variable = { which = heretic_bastion value = 1 }
				change_variable = { which = church_bastion value = 1 }
			}
			#DETERMINE BEST LOCATION FOR HERETIC BASTIONS
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 10 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 10 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 9 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 8.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 8 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 7 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 7 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 5.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 6 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 4 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 5 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 2.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 4 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 1 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 3 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 2 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 1 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			#DETERMINE BEST LOCATION FOR CHURCH BASTIONS
			every_owned_province = {
				limit = {
					is_city = yes
					has_owner_religion = yes
				}
				if = {
					limit = { NOT = { is_core = ROOT } }
					change_variable = { which = church_bastion value = -1 }
				}
				if = {
					limit = {
						OR = {
							culture_group = ROOT
							has_owner_accepted_culture = yes
						}
					}
					change_variable = { which = church_bastion value = 1 }
				}
				if = {
					limit = {
						any_neighbor_province = { NOT = { owned_by = ROOT } }
					}
					change_variable = { which = church_bastion value = -1 }
				}
				if = {
					limit = { NOT = { has_province_flag = heretic_bastion } }
					change_variable = { which = church_bastion		value = 5 }
					set_variable = { which = church_bastion_local value = 0 }
					if = {
						limit = {
							check_variable = { which = religious_uprising value = 5 }
						}
						change_variable = { which = church_bastion_local value = 5 }
					}
					else_if = {
						limit = {
							check_variable = { which = religious_uprising value = 1 }
						}
						change_variable = { which = church_bastion_local which = religious_uprising }
					}
					subtract_variable = { which = church_bastion which = church_bastion_local }
					set_variable = { which = church_bastion_local value = 0 }
				}
				change_variable = { which = church_bastion		value = 5 }
				set_variable = { which = church_bastion_neighbor value = 0 }
				if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 5 } }
					}
					set_variable = { which = church_bastion_neighbor value = 5 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 4 } }
					}
					set_variable = { which = church_bastion_neighbor value = 4 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 3 } }
					}
					set_variable = { which = church_bastion_neighbor value = 3 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 2 } }
					}
					set_variable = { which = church_bastion_neighbor value = 2 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 1 } }
					}
					set_variable = { which = church_bastion_neighbor value = 1 }
				}
				subtract_variable = { which = church_bastion which = church_bastion_neighbor }
				set_variable = { which = church_bastion_neighbor value = 0 }
			}
			capital_scope = {
				change_variable = { which = church_bastion value = 2 }
			}
			random_owned_province = { #Capital first if not heretic
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 5 }
					has_owner_religion = yes
					is_capital = yes
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 5 }
					has_owner_religion = yes
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 10 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 10 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 9 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 8.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 8 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 7 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 7 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 5.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 6 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 4 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 5 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 2.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 4 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 1 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 3 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 2 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 1 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			#Tell interested players about this event
			#Same religion countries
			every_known_country = {
				limit = {
					ai = no
					OR = {
						AND = {
							is_neighbor_of = ROOT
							has_country_flag = religious_news_major
							OR = {
								is_rival = ROOT
								alliance_with = ROOT
								overlord_of = ROOT
								vassal_of = ROOT
								junior_union_with = ROOT
								truce_with = ROOT
								marriage_with = ROOT
								war_with = ROOT
							}
						}
						AND = {
							has_country_flag = religious_news_trivial
							OR = {
								is_rival = ROOT
								alliance_with = ROOT
								overlord_of = ROOT
								vassal_of = ROOT
								junior_union_with = ROOT
								is_neighbor_of = ROOT
								marriage_with = ROOT
								piety = 0.20
							}
						}
						has_country_flag = religious_news_all
					}
				}
				if = {
					limit = {
						religion = ROOT
					}
					set_country_flag = religious_war_government_notifier
					country_event = { id = dg_turmoil.066 days = 15 }
				}
				if = {
					limit = {
						PREV = { has_country_flag = religious_turmoil_hussite }
						religion = hussite
					}
					set_country_flag = religious_war_rebel_notifier
					country_event = { id = dg_turmoil.067 days = 15 }
				}
			}
			#Other countries
			every_known_country = {
				limit = {
					ai = no
					NOT = { has_country_flag = religious_war_rebel_notifier }
					NOT = { has_country_flag = religious_war_government_notifier }
					OR = {
						AND = {
							has_country_flag = religious_news_major
							OR = {
								war_with = ROOT
								vassal_of = ROOT
								overlord_of = ROOT
								junior_union_with = ROOT
							}
						}
						AND = {
							has_country_flag = religious_news_trivial
							OR = {
								is_rival = ROOT
								AND = {
									culture_group = ROOT
									religion_group = ROOT
								}
								AND = {
									is_neighbor_of = ROOT
									religion_group = ROOT
								}
								AND = {
									culture_group = ROOT
									religion_group = ROOT
								}
							}
						}
						AND = {
							has_country_flag = religious_news_all
							OR = {
								is_neighbor_of = ROOT
								culture_group = ROOT
								marriage_with = ROOT
							}
						}
					}
				}
				set_country_flag = religious_war_neighbor_notifier
				country_event = { id = dg_turmoil.068 days = 15 }
			}
		}
	}
	
	option = {
		name = dg_hussite.014.a #Put down the insurrection
		ai_chance = { factor = 90 }
		hidden_effect = {
			set_country_flag = internal_crusade
			set_country_flag = religious_turmoil_hussite
			set_country_flag = religious_turmoil_happening
			capital_scope = { set_province_flag = crusade_goal }
		}
		force_converted = yes
		add_legitimacy = -25
		add_prestige = -25
		subtract_stability_2 = yes
		every_owned_province = {
			limit = { has_province_flag = heretic_bastion }
			add_province_modifier = { name = heretic_bastion duration = 3000 }
			hidden_effect = {
				set_variable = { which = rural_percentage_removed   value = 0.6 }
				remove_rural_population_DEVS = yes
				set_variable = { which = urban_percentage_removed   value = 0.3 }
				remove_urban_population_DEVS = yes
				change_variable = { which = hussite value = 6 }
				change_variable = { which = province_religion value = -6 }
			}
		}
		every_owned_province = {
			limit = { has_province_flag = church_bastion }
			add_province_modifier = { name = church_bastion duration = 3000 }
		}
		every_owned_province = {
			limit = { has_province_flag = heretic_bastion }
			spawn_rebels = { type = taborite_rebels size = 1 }
		}
		every_owned_province = {
			limit = {
				NOT = { has_province_flag = heretic_bastion }
				OR = {
					check_variable = { which = religious_uprising value = 4 }
					AND = {
						owner = { ai = no }
						check_variable = { which = religious_uprising value = 3 }
					}
				}
			}
			hidden_effect = {
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
			spawn_rebels = { type = taborite_rebels size = 1 }
		}
		every_owned_province = {
			limit = {
				NOT = { has_province_flag = heretic_bastion }
				NOT = { check_variable = { which = religious_uprising value = 4 } }
				OR = {
					owner = { ai = no }
					NOT = { check_variable = { which = religious_uprising value = 3 } }
				}
				check_variable = { which = religious_uprising value = 2 }
			}
			spawn_rebels = { type = taborite_rebels size = 0 }
		}
		every_owned_province = { #Must be done after rebels appear or the game does not obey this command
			limit = { has_province_flag = heretic_bastion }
			change_controller = REB
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
	option = {
		name = dg_hussite.014.b #Side with the Hussites
		set_country_flag = religious_civil_war
		set_country_flag = religious_turmoil_catholic
		set_country_flag = religious_turmoil_happening
		add_legitimacy = -50
		add_prestige = -50
		every_owned_province = {
			limit = { has_province_flag = heretic_bastion }
			add_province_modifier = { name = church_bastion duration = 3000 }
		}
		every_owned_province = {
			limit = { has_province_flag = church_bastion }
			add_province_modifier = { name = heretic_bastion duration = 3000 }
		}
		every_owned_province = {
			limit = { has_province_flag = church_bastion }
			spawn_rebels = { type = catholic_rebels size = 1 }
		}
		every_owned_province = {
			limit = {
				religion = catholic
				NOT = { check_variable = { which = hussite value = 4 } }
				is_city = yes
				is_core = ROOT
			}
			spawn_rebels = { type = catholic_rebels size = 1 }
		}
		every_owned_province = {
			limit = {
				religion = catholic
				check_variable = { which = hussite value = 4 }
				is_city = yes
				is_core = ROOT
			}
			spawn_rebels = { type = catholic_rebels size = 0 }
		}
		set_country_flag = voluntary_conversion
		if = {
			limit = { NOT = { is_religion_enabled = hussite } }
			custom_tooltip = convert_dangerous_religion
			subtract_stability_1 = yes
		}
		if = {
			limit = { check_variable = { which = hussite_population value = 75 } }
			custom_tooltip = convert_population_75
			add_stability_1 = yes
		}
		else_if = {
			limit = { check_variable = { which = hussite_population value = 50 } }
			custom_tooltip = convert_population_50
		}
		else_if = {
			limit = { check_variable = { which = hussite_population value = 25 } }
			custom_tooltip = convert_population_25
			subtract_stability_1 = yes
		}
		else = {
			custom_tooltip = convert_population_0
			subtract_stability_2 = yes
		}
		if = {
			limit = { patriarch_authority = 0.75 }
			custom_tooltip = convert_church_strong
			subtract_stability_2 = yes
		}
		else_if = {
			limit = { patriarch_authority = 0.50 }
			custom_tooltip = convert_piety_moderate
			subtract_stability_1 = yes
		}
		else_if = {
			limit = { patriarch_authority = 0.25 }
			custom_tooltip = convert_church_weak
		}
		else = {
			custom_tooltip = convert_church_insignificant
		}
		if = {
			limit = { ADM = 5 }
			if = {
				limit = {
					capital_scope = { religion = hussite }
				}
				custom_tooltip = convert_ruler_strong
				add_stability_3 = yes
			}
			else = {
				custom_tooltip = convert_ruler_moderate
				add_stability_2 = yes
			}
		}
		else_if = {
			limit = { ADM = 3 }
			if = {
				limit = {
					capital_scope = { religion = hussite }
				}
				custom_tooltip = convert_ruler_moderate
				add_stability_2 = yes
			}
			else = {
				custom_tooltip = convert_ruler_weak
				add_stability_1 = yes
			}
		}
		else = {
			if = {
				limit = {
					capital_scope = { religion = hussite }
				}
				custom_tooltip = convert_ruler_weak
				add_stability_1 = yes
			}
			else = {
				custom_tooltip = convert_ruler_incompetent
			}
		}
		if = {
			limit = { advisor = theologian }
			custom_tooltip = convert_theologian
			add_stability_1 = yes
		}
		if = {
			limit = { has_country_flag = was_hussite }
			if = {
				limit = {
					check_variable = { which = sympathy_to_old_religion value = 1 }
				}
				custom_tooltip = convert_previous_recent
				add_stability_2 = yes
			}
			else = {
				custom_tooltip = convert_previous_old
				add_stability_1 = yes
			}
		}
		else = {
			if = {
				limit = {
					check_variable = { which = sympathy_to_old_religion value = 1 }
				}
				custom_tooltip = convert_recent
				add_stability_1 = yes
			}
		}
		change_religion = hussite
		force_converted = yes
		every_owned_province = { #Must be done after rebels appear or the game does not obey this command
			limit = { has_province_flag = church_bastion }
			change_controller = REB
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
}

country_event = { #The Defenestration of $CAPITAL_CITY$ (ahistorical version)
	
	id = dg_hussite.015
	title = dg_hussite.014.t
	desc = dg_hussite.015.d
	picture = protestant_defenestration
	
	trigger = {
		has_country_flag = hussite_league_formed
		has_country_flag = leaning_catholic
		NOT = { is_religion_enabled = protestant }
		PAP = { has_country_flag = lollardy_banned }
		NOT = { PAP = { has_country_flag = hussite_wars } }
		NOT = { religion = hussite }
		OR = {
			check_variable = { which = inquisition value = 2 }
			has_regency = yes
			NOT = { DIP = 2 }
			NOT = { ADM = 2 }
			NOT = { MIL = 2 }
		}
		capital_scope = {
			has_owner_culture = yes
			check_variable = { which = hussite value = 4 }
		}
	}
	
	mean_time_to_happen = {
		
		months = 50
		
		modifier = {
			has_regency = yes
			factor = 0.1
		}
		modifier = {
			has_country_flag = religious_turmoil_hussite
			factor = 0.5
		}
		modifier = {
			any_owned_province = {
				religion = hussite
				has_missionary = yes
			}
			factor = 0.5
		}
	}
	
	immediate = {
		set_global_flag = dates_of_interest_defenestration_of_prague_1419
		clr_country_flag = leaning_catholic
		hidden_effect = {
			set_country_flag = internal_crusade
			capital_scope = { set_province_flag = crusade_goal }
			set_country_flag = hussite_wars_target
			PAP = { set_country_flag = hussite_wars }
			regiongroup = {
				region = {
					limit = { check_variable = { which = lollard_supporters value = 1 } }
					change_variable = { which = hussite which = lollard_supporters }
					subtract_variable = { which = province_religion which = lollard_supporters }
					set_variable = { which = lollard_supporters value = 0 }
				}
			}
		}
		every_country = {
			limit = {
				religion = catholic
				OR = {
					is_neighbor_of = ROOT
					is_elector = yes
					is_emperor = yes
					is_papal_controller = yes
					is_subject_of = ROOT
				}
				NOT = { tag = ROOT }
			}
			add_opinion = { who = ROOT modifier = throneless_king }
		}
		if = {
			limit = { has_heir = yes }
			exile_heir_as = hussite_war_heir
			set_country_flag = hussite_war_heir
		}
		define_heir = { age = 10 dynasty = ROOT }
		if = {
			limit = { has_ruler = yes }
			exile_ruler_as = hussite_war_ruler
			set_country_flag = hussite_war_ruler
		}
		define_ruler = {
			regency = yes
			ADM = 0
			DIP = 0
			MIL = 0
		}
		#if = {
		#	limit = { has_country_modifier = edict_of_tolerance }
			remove_country_modifier = edict_of_tolerance
		#}
		add_war_exhaustion = 2
		if = {
			limit = { piety = 0.60 }
			add_country_modifier = { name = religious_intolerance duration = 1600 }
		}
		else_if = {
			limit = { piety = 0.20 }
			add_country_modifier = { name = religious_intolerance duration = 800 }
		}
		else_if = {
			limit = { piety = -0.20 }
			add_country_modifier = { name = religious_intolerance duration = 400 }
		}
		hidden_effect = {
			set_country_flag = war_of_religion_fought
			set_country_flag = religious_civil_war
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = {
				if = {
					limit = { check_variable = { which = hussite value = 20 } }
					change_variable = { which = religious_uprising value = 7 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 16 } }
					change_variable = { which = religious_uprising value = 6 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 12 } }
					change_variable = { which = religious_uprising value = 5 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 8 } }
					change_variable = { which = religious_uprising value = 4 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 6 } }
					change_variable = { which = religious_uprising value = 3 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 4 } }
					change_variable = { which = religious_uprising value = 2 }
				}
				else_if = {
					limit = { check_variable = { which = hussite value = 2 } }
					change_variable = { which = religious_uprising value = 1 }
				}
				if = {
					limit = { is_colony = yes }
					change_variable = { which = religious_uprising value = -2 }
				}
			}
			set_variable = { which = heretic_bastion value = 1 }
			set_variable = { which = church_bastion value = 1 }
			if = {
				limit = { num_of_cities = 50 } #Larger countries get larger uprisings
				change_variable = { which = heretic_bastion value = 4 }
				change_variable = { which = church_bastion value = 4 }
			}
			else_if = {
				limit = { num_of_cities = 25 }
				change_variable = { which = heretic_bastion value = 3 }
				change_variable = { which = church_bastion value = 3 }
			}
			else_if = {
				limit = { num_of_cities = 12 }
				change_variable = { which = heretic_bastion value = 2 }
				change_variable = { which = church_bastion value = 2 }
			}
			else_if = {
				limit = { num_of_cities = 8 }
				change_variable = { which = heretic_bastion value = 1 }
				change_variable = { which = church_bastion value = 1 }
			}
			#DETERMINE BEST LOCATION FOR HERETIC BASTIONS
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 10 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 10 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 9 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 8.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 8 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 7 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 7 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 5.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 6 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 4 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 5 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 2.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 4 }
					any_neighbor_province = { check_variable = { which = religious_uprising value = 1 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 3 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 2 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = heretic_bastion value = 1 } }
					check_variable = { which = religious_uprising value = 1 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
				}
				owner = { change_variable = { which = heretic_bastion value = -1 } }
				set_province_flag = heretic_bastion
			}
			#DETERMINE BEST LOCATION FOR CHURCH BASTIONS
			every_owned_province = {
				limit = {
					is_city = yes
					has_owner_religion = yes
				}
				if = {
					limit = { NOT = { is_core = ROOT } }
					change_variable = { which = church_bastion value = -1 }
				}
				if = {
					limit = {
						OR = {
							culture_group = ROOT
							has_owner_accepted_culture = yes
						}
					}
					change_variable = { which = church_bastion value = 1 }
				}
				if = {
					limit = {
						any_neighbor_province = { NOT = { owned_by = ROOT } }
					}
					change_variable = { which = church_bastion value = -1 }
				}
				if = {
					limit = { NOT = { has_province_flag = heretic_bastion } }
					change_variable = { which = church_bastion		value = 5 }
					set_variable = { which = church_bastion_local value = 0 }
					if = {
						limit = {
							check_variable = { which = religious_uprising value = 5 }
						}
						change_variable = { which = church_bastion_local value = 5 }
					}
					else_if = {
						limit = {
							check_variable = { which = religious_uprising value = 1 }
						}
						change_variable = { which = church_bastion_local which = religious_uprising }
					}
					subtract_variable = { which = church_bastion which = church_bastion_local }
					set_variable = { which = church_bastion_local value = 0 }
				}
				change_variable = { which = church_bastion		value = 5 }
				set_variable = { which = church_bastion_neighbor value = 0 }
				if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 5 } }
					}
					set_variable = { which = church_bastion_neighbor value = 5 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 4 } }
					}
					set_variable = { which = church_bastion_neighbor value = 4 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 3 } }
					}
					set_variable = { which = church_bastion_neighbor value = 3 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 2 } }
					}
					set_variable = { which = church_bastion_neighbor value = 2 }
				}
				else_if = {
					limit = {
						any_neighbor_province = { check_variable = { which = religious_uprising value = 1 } }
					}
					set_variable = { which = church_bastion_neighbor value = 1 }
				}
				subtract_variable = { which = church_bastion which = church_bastion_neighbor }
				set_variable = { which = church_bastion_neighbor value = 0 }
			}
			capital_scope = {
				change_variable = { which = church_bastion value = 2 }
			}
			random_owned_province = { #Capital first if not heretic
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 5 }
					has_owner_religion = yes
					is_capital = yes
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 5 }
					has_owner_religion = yes
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 10 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 10 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 9 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 8.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 8 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 7 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 7 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 5.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 6 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 4 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 5 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 2.5 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 4 }
					any_neighbor_province = { check_variable = { which = church_bastion value = 1 } }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 3 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 2 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			random_owned_province = {
				limit = {
					owner = { check_variable = { which = church_bastion value = 1 } }
					check_variable = { which = church_bastion value = 1 }
					NOT = { has_province_flag = church_bastion }
					NOT = { has_province_flag = heretic_bastion }
					NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
				}
				owner = { change_variable = { which = church_bastion value = -1 } }
				set_province_flag = church_bastion
			}
			#Tell interested players about this event
			#Same religion countries
			every_known_country = {
				limit = {
					ai = no
					OR = {
						AND = {
							is_neighbor_of = ROOT
							has_country_flag = religious_news_major
							OR = {
								is_rival = ROOT
								alliance_with = ROOT
								overlord_of = ROOT
								vassal_of = ROOT
								junior_union_with = ROOT
								truce_with = ROOT
								marriage_with = ROOT
								war_with = ROOT
							}
						}
						AND = {
							has_country_flag = religious_news_trivial
							OR = {
								is_rival = ROOT
								alliance_with = ROOT
								overlord_of = ROOT
								vassal_of = ROOT
								junior_union_with = ROOT
								is_neighbor_of = ROOT
								marriage_with = ROOT
								piety = 0.20
							}
						}
						has_country_flag = religious_news_all
					}
				}
				if = {
					limit = {
						religion = ROOT
					}
					set_country_flag = religious_war_government_notifier
					country_event = { id = dg_turmoil.066 days = 15 }
				}
				if = {
					limit = {
						PREV = { has_country_flag = religious_turmoil_hussite }
						religion = hussite
					}
					set_country_flag = religious_war_rebel_notifier
					country_event = { id = dg_turmoil.067 days = 15 }
				}
			}
			#Other countries
			every_known_country = {
				limit = {
					ai = no
					NOT = { has_country_flag = religious_war_rebel_notifier }
					NOT = { has_country_flag = religious_war_government_notifier }
					OR = {
						AND = {
							has_country_flag = religious_news_major
							OR = {
								war_with = ROOT
								vassal_of = ROOT
								overlord_of = ROOT
								junior_union_with = ROOT
							}
						}
						AND = {
							has_country_flag = religious_news_trivial
							OR = {
								is_rival = ROOT
								AND = {
									culture_group = ROOT
									religion_group = ROOT
								}
								AND = {
									is_neighbor_of = ROOT
									religion_group = ROOT
								}
								AND = {
									culture_group = ROOT
									religion_group = ROOT
								}
							}
						}
						AND = {
							has_country_flag = religious_news_all
							OR = {
								is_neighbor_of = ROOT
								culture_group = ROOT
								marriage_with = ROOT
							}
						}
					}
				}
				set_country_flag = religious_war_neighbor_notifier
				country_event = { id = dg_turmoil.068 days = 15 }
			}
		}
	}
	
	option = {
		name = dg_hussite.014.a #Put down the insurrection
		hidden_effect = {
			set_country_flag = religious_turmoil_hussite
			set_country_flag = religious_turmoil_happening
		}
		force_converted = yes
		subtract_stability_2 = yes
		add_legitimacy = -25
		add_prestige = -25
		every_owned_province = {
			limit = { has_province_flag = heretic_bastion }
			add_province_modifier = { name = heretic_bastion duration = 3000 }
			hidden_effect = {
				set_variable = { which = rural_percentage_removed   value = 0.6 }
				remove_rural_population_DEVS = yes
				set_variable = { which = urban_percentage_removed   value = 0.3 }
				remove_urban_population_DEVS = yes
				change_variable = { which = hussite value = 6 }
				change_variable = { which = province_religion value = -6 }
			}
		}
		every_owned_province = {
			limit = { has_province_flag = church_bastion }
			add_province_modifier = { name = church_bastion duration = 3000 }
		}
		every_owned_province = {
			limit = { has_province_flag = heretic_bastion }
			spawn_rebels = { type = taborite_rebels size = 1 }
		}
		every_owned_province = {
			limit = {
				NOT = { has_province_flag = heretic_bastion }
				OR = {
					check_variable = { which = religious_uprising value = 4 }
					AND = {
						owner = { ai = no }
						check_variable = { which = religious_uprising value = 3 }
					}
				}
			}
			hidden_effect = {
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
			spawn_rebels = { type = taborite_rebels size = 1 }
		}
		every_owned_province = {
			limit = {
				NOT = { has_province_flag = heretic_bastion }
				NOT = { check_variable = { which = religious_uprising value = 4 } }
				OR = {
					owner = { ai = no }
					NOT = { check_variable = { which = religious_uprising value = 3 } }
				}
				check_variable = { which = religious_uprising value = 2 }
			}
			spawn_rebels = { type = taborite_rebels size = 0 }
		}
		every_owned_province = { #Must be done after rebels appear or the game does not obey this command
			limit = { has_province_flag = heretic_bastion }
			change_controller = REB
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
}

country_event = { #18 - Massacre in $CAPITAL_CITY$ (pro-Hussite)
	
	id = dg_hussite.018
	title = dg_hussite.018.t
	desc = dg_hussite.018.d
	picture = all_massacre
	
	trigger = {
		has_country_flag = hussite_league_formed
		OR = {
			has_country_flag = leaning_hussite
			has_country_flag = useful_hussite
			has_spawned_rebels = hussite_rebels
		}
		NOT = { PAP = { has_country_flag = hussite_wars } }
		NOT = { capital_scope = { has_province_modifier = religious_massacre } }
		NOT = { is_religion_enabled = protestant }
		PAP = { has_country_flag = lollardy_banned }
		any_owned_province = {
			has_owner_culture = yes
			is_in_capital_area = yes
			check_variable = { which = catholic value = 6 }
		}
		any_owned_province = {
			has_owner_culture = yes
			is_in_capital_area = yes
			check_variable = { which = hussite value = 6 }
		}
	}
	
	mean_time_to_happen = {
		
		years = 25
		
		modifier = {
			has_country_modifier = religious_intolerance
			factor = 0.5
		}
		modifier = {
			capital_scope = { has_owner_religion = no }
			factor = 0.5
		}
		modifier = {
			check_variable = { which = catholic_population value = 40 }
			check_variable = { which = hussite_population value = 40 }
			factor = 0.5
		}
		modifier = {
			check_variable = { which = catholic_population value = 30 }
			check_variable = { which = hussite_population value = 30 }
			factor = 0.5
		}
		modifier = {
			check_variable = { which = catholic_population value = 20 }
			check_variable = { which = hussite_population value = 20 }
			factor = 0.5
		}
		modifier = {
			has_country_flag = changed_sides_hussite
			factor = 0.1
		}
		modifier = {
			NOT = { DIP = 2 }
			factor = 0.5
		}
		modifier = {
			NOT = { MIL = 2 }
			factor = 0.5
		}
		modifier = {
			NOT = { ADM = 2 }
			factor = 0.5
		}
		modifier = {
			has_regency = yes
			factor = 0.5
		}
		modifier = {
			has_spawned_rebels = hussite_rebels
			factor = 0.5
		}
	}
	
	immediate = {
		hidden_effect = { change_variable = { which = hussite_massacres_happened value = 1 } } #For tracking only
		if = {
			limit = {
				OR = {
					AND = {
						religion = catholic
						OR = {
							has_country_flag = useful_hussite
							has_country_flag = leaning_hussite
						}
					}
					religion = hussite
				}
			}
			custom_tooltip = massacre_by_hussites
		}
		if = {
			limit = {
				religion = catholic
				NOT = { has_country_flag = useful_hussite }
				NOT = { has_country_flag = leaning_hussite }
			}
			custom_tooltip = massacre_by_catholics
		}
		if = {
			limit = { has_country_flag = changed_sides_hussites }
			custom_tooltip = revenge_massacre_explained
			clr_country_flag = changed_sides_hussites
		}
		subtract_stability_1 = yes
		add_yearly_manpower = -0.10
		capital_scope = { add_province_modifier = { name = religious_massacre duration = 1000 } }
		set_country_flag = catholic_massacre
	}
	
	option = {
		name = dg_hussite.018.a #Hang the perpetrators and revoke their titles (changes sides)
		trigger = { MIL = 3 }
		ai_chance = {
			factor = 25
			modifier = {
				NOT = { stability = 1 }
				factor = 0.5
			}
			modifier = {
				NOT = { stability = -1 }
				factor = 0
			}
		}
		if = {
			limit = {
				OR = {
					NOT = { religion = catholic }
					has_country_flag = useful_hussite
					has_country_flag = leaning_hussite
				}
			}
			clr_country_flag = useful_hussite
			clr_country_flag = leaning_hussite
			set_country_flag = leaning_catholic
			set_country_flag = useful_catholic
			set_country_flag = changed_sides_hussites
		}
		if = {
			limit = {
				religion = catholic
				NOT = { has_country_flag = useful_hussite }
				NOT = { has_country_flag = leaning_hussite }
				NOT = { has_country_flag = changed_sides_hussites }
			}
			clr_country_flag = leaning_catholic
			clr_country_flag = useful_catholic
			set_country_flag = leaning_hussite
			set_country_flag = useful_hussite
			set_country_flag = changed_sides_hussites
		}
		add_mil_power = -25
		subtract_stability_2 = yes
		kill_advisor = random
		kill_leader = {
			type = random
		}
	}
	option = {
		name = dg_hussite.018.b #Send in troops to restore order
		ai_chance = { factor = 25 }
		if = {
			limit = { OR = { has_country_flag = leaning_hussite has_country_flag = useful_hussite NOT = { religion = catholic } } }
			capital_scope = { spawn_rebels = { type = hussite_rebels size = 1 } }
		}
		if = {
			limit = { religion = catholic NOT = { has_country_flag = useful_hussite } NOT = { has_country_flag = leaning_hussite } }
			capital_scope = { spawn_rebels = { type = catholic_rebels size = 1 } }
		}
		if = {
			limit = { piety = 0.60 }
			add_country_modifier = { name = religious_tolerance duration = 800 }
		}
		else_if = {
			limit = { piety = 0.20 }
			add_country_modifier = { name = religious_tolerance duration = 400 }
		}
		else_if = {
			limit = { piety = -0.20 }
			add_country_modifier = { name = religious_tolerance duration = 200 }
		}
		capital_scope = {
			hidden_effect = {
				set_variable = { which = added_unrest value = -10 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_10
		}
		add_mil_power = -50
	}
	option = {
		name = dg_hussite.018.c #Let our silence speak for itself
		ai_chance = {
			factor = 25
			modifier = {
				NOT = { legitimacy = 95 }
				factor = 0.5
			}
			modifier = {
				NOT = { legitimacy = 85 }
				factor = 0.5
			}
			modifier = {
				NOT = { legitimacy = 75 }
				factor = 0
			}
		}
		clr_country_flag = useful_catholic
		clr_country_flag = useful_hussite
		add_legitimacy = -10
		if = {
			limit = { piety = 0.60 }
			add_country_modifier = { name = religious_intolerance duration = 800 }
		}
		else_if = {
			limit = { piety = 0.20 }
			add_country_modifier = { name = religious_intolerance duration = 400 }
		}
		else_if = {
			limit = { piety = -0.20 }
			add_country_modifier = { name = religious_intolerance duration = 200 }
		}
		hidden_effect = {
			if = {
				limit = { religion = hussite }
				capital_scope = { change_variable = { which = converted_heretics value = 1 } }
			}
			if = {
				limit = {
					religion = catholic
					capital_scope = { religion = hussite check_variable = { which = catholic value = 2 } }
				}
				capital_scope = {
					change_variable = { which = catholic value = -1 }
					change_variable = { which = province_religion value = 1 }
				}
			}
			if = {
				limit = {
					religion = catholic
					NOT = { capital_scope = { religion = hussite check_variable = { which = catholic value = 2 } } }
				}
				capital_scope = {
					change_variable = { which = province_religion value = -1 }
					change_variable = { which = hussite value = 1 }
				}
			}
		}
	}
	option = {
		name = dg_hussite.018.e #Take control of the persecution personally
		trigger = { OR = { has_regency = no has_consort_regency = yes } }
		ai_chance = {
			factor = 25
			modifier = {
				NOT = { legitimacy = 95 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 85 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 75 }
				factor = 1.4
			}
			modifier = {
				NOT = { stability = 1 }
				factor = 1.4
			}
			modifier = {
				NOT = { stability = -1 }
				factor = 1.4
			}
		}
		add_stability_1 = yes
		add_legitimacy = 10
		if = {
			limit = { piety = 0.60 }
			add_country_modifier = { name = religious_intolerance duration = 1600 }
		}
		else_if = {
			limit = { piety = 0.20 }
			add_country_modifier = { name = religious_intolerance duration = 800 }
		}
		else_if = {
			limit = { piety = -0.20 }
			add_country_modifier = { name = religious_intolerance duration = 400 }
		}
		if = {
			limit = { religion = catholic NOT = { has_country_flag = leaning_hussite } NOT = { has_country_flag = useful_hussite } }
			every_owned_province = {
				limit = { religion = catholic }
				add_province_modifier = { name = religious_massacre duration = 500 }
				hidden_effect = {
					change_variable = { which = province_religion value = -2 }
					change_variable = { which = hussite value = 2 }
				}
			}
			capital_scope = { spawn_rebels = { type = hussite_rebels size = 1 } }
			if = {
				limit = { num_of_cities = 5 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = hussite value = 4 } }
					spawn_rebels = { type = hussite_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 10 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = hussite value = 4 } }
					spawn_rebels = { type = hussite_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 15 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = hussite value = 4 } }
					spawn_rebels = { type = hussite_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 20 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = hussite value = 4 } }
					spawn_rebels = { type = hussite_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 25 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = hussite value = 4 } }
					spawn_rebels = { type = hussite_rebels size = 1 }
				}
			}
		}
		if = {
			limit = {
				OR = {
					religion = hussite
					has_country_flag = leaning_hussite
					has_country_flag = useful_hussite
				}
			}
			capital_scope = { spawn_rebels = { type = catholic_rebels size = 1 } }
			if = {
				limit = { num_of_cities = 5 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = catholic value = 4 } }
					spawn_rebels = { type = catholic_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 10 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = catholic value = 4 } }
					spawn_rebels = { type = catholic_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 15 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = catholic value = 4 } }
					spawn_rebels = { type = catholic_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 20 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = catholic value = 4 } }
					spawn_rebels = { type = catholic_rebels size = 1 }
				}
			}
			if = {
				limit = { num_of_cities = 25 }
				random_owned_province = {
					limit = { is_in_capital_area = yes has_owner_culture = yes check_variable = { which = catholic value = 4 } }
					spawn_rebels = { type = catholic_rebels size = 1 }
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { religion = hussite }
				capital_scope = { change_variable = { which = converted_heretics value = 2 } }
			}
			if = {
				limit = {
					religion = catholic
					capital_scope = { religion = hussite check_variable = { which = catholic value = 2 } }
				}
				capital_scope = {
					change_variable = { which = catholic value = -2 }
					change_variable = { which = province_religion value = 2 }
				}
			}
			if = {
				limit = {
					religion = catholic
					NOT = { capital_scope = { religion = hussite check_variable = { which = catholic value = 2 } } }
				}
				capital_scope = {
					change_variable = { which = province_religion value = -2 }
					change_variable = { which = hussite value = 2 }
				}
			}
		}
	}
}

################
# Hussite Wars # 20s and 30s
################

country_event = { #The Four Articles of $CAPITAL_CITY$ (1420)
	
	id = dg_hussite.021
	title = dg_hussite.021.t
	desc = dg_hussite.021.d
	picture = hussite_barons
	
	trigger = {
		OR = {
			has_country_flag = hussite_wars_target
			has_country_flag = leaning_hussite
		}
		OR = {
			PAP = { has_country_flag = hussite_wars }
			AND = {
				has_country_flag = leaning_hussite
				OR = {
					has_regency = yes
					NOT = { months_of_ruling = 6 }
				}
			}
		}
		NOT = { is_religion_enabled = hussite }
	}
	
	mean_time_to_happen = {
		
		months = 6
		
		modifier = {
			NOT = { has_country_flag = hussite_wars_target }
			has_regency = no
			factor = 0.1
		}
	}
	
	immediate = {
		enable_religion = hussite
		hidden_effect = {
			if = {
				limit = { NOT = { has_country_flag = hussite_wars_target } }
				set_country_flag = internal_crusade
				capital_scope = { set_province_flag = crusade_goal }
				set_country_flag = hussite_wars_target
				set_global_flag = dates_of_interest_defenestration_of_prague_ahistorical_1419
				PAP = { set_country_flag = hussite_wars }
				regiongroup = {
					region = {
						limit = { check_variable = { which = lollard_supporters value = 1 } }
						change_variable = { which = hussite which = lollard_supporters }
						subtract_variable = { which = province_religion which = lollard_supporters }
						set_variable = { which = lollard_supporters value = 0 }
					}
				}
				every_country = {
					limit = {
						religion = ROOT
						OR = {
							is_neighbor_of = ROOT
							is_elector = yes
							is_emperor = yes
							is_papal_controller = yes
							is_subject_of = ROOT
						}
						NOT = { tag = ROOT }
					}
					add_opinion = { who = ROOT modifier = throneless_king }
				}
				#if = {
				#	limit = { has_country_modifier = edict_of_tolerance }
					remove_country_modifier = edict_of_tolerance
				#}
				set_country_flag = war_of_religion_fought
				set_country_flag = religious_civil_war
				every_owned_province = {
					set_variable = { which = religious_uprising value = 0 }
					if = {
						limit = { check_variable = { which = hussite value = 20 } }
						change_variable = { which = religious_uprising value = 7 }
					}
					else_if = {
						limit = { check_variable = { which = hussite value = 16 } }
						change_variable = { which = religious_uprising value = 6 }
					}
					else_if = {
						limit = { check_variable = { which = hussite value = 12 } }
						change_variable = { which = religious_uprising value = 5 }
					}
					else_if = {
						limit = { check_variable = { which = hussite value = 8 } }
						change_variable = { which = religious_uprising value = 4 }
					}
					else_if = {
						limit = { check_variable = { which = hussite value = 6 } }
						change_variable = { which = religious_uprising value = 3 }
					}
					else_if = {
						limit = { check_variable = { which = hussite value = 4 } }
						change_variable = { which = religious_uprising value = 2 }
					}
					else_if = {
						limit = { check_variable = { which = hussite value = 2 } }
						change_variable = { which = religious_uprising value = 1 }
					}
					if = {
						limit = { is_colony = yes }
						change_variable = { which = religious_uprising value = -2 }
					}
				}
				set_variable = { which = heretic_bastion value = 1 }
				set_variable = { which = church_bastion value = 1 }
				if = {
					limit = { num_of_cities = 50 } #Larger countries get larger uprisings
					change_variable = { which = heretic_bastion value = 4 }
					change_variable = { which = church_bastion value = 4 }
				}
				else_if = {
					limit = { num_of_cities = 25 }
					change_variable = { which = heretic_bastion value = 3 }
					change_variable = { which = church_bastion value = 3 }
				}
				else_if = {
					limit = { num_of_cities = 12 }
					change_variable = { which = heretic_bastion value = 2 }
					change_variable = { which = church_bastion value = 2 }
				}
				else_if = {
					limit = { num_of_cities = 8 }
					change_variable = { which = heretic_bastion value = 1 }
					change_variable = { which = church_bastion value = 1 }
				}
				#DETERMINE BEST LOCATION FOR HERETIC BASTIONS
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 10 }
						any_neighbor_province = { check_variable = { which = religious_uprising value = 10 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 9 }
						any_neighbor_province = { check_variable = { which = religious_uprising value = 8.5 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 8 }
						any_neighbor_province = { check_variable = { which = religious_uprising value = 7 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 7 }
						any_neighbor_province = { check_variable = { which = religious_uprising value = 5.5 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 6 }
						any_neighbor_province = { check_variable = { which = religious_uprising value = 4 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 5 }
						any_neighbor_province = { check_variable = { which = religious_uprising value = 2.5 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 4 }
						any_neighbor_province = { check_variable = { which = religious_uprising value = 1 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 3 }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 2 }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = heretic_bastion value = 1 } }
						check_variable = { which = religious_uprising value = 1 }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
					}
					owner = { change_variable = { which = heretic_bastion value = -1 } }
					set_province_flag = heretic_bastion
				}
				#DETERMINE BEST LOCATION FOR CHURCH BASTIONS
				every_owned_province = {
					limit = {
						is_city = yes
						has_owner_religion = yes
					}
					if = {
						limit = { NOT = { is_core = ROOT } }
						change_variable = { which = church_bastion value = -1 }
					}
					if = {
						limit = {
							OR = {
								culture_group = ROOT
								has_owner_accepted_culture = yes
							}
						}
						change_variable = { which = church_bastion value = 1 }
					}
					if = {
						limit = {
							any_neighbor_province = { NOT = { owned_by = ROOT } }
						}
						change_variable = { which = church_bastion value = -1 }
					}
					if = {
						limit = { NOT = { has_province_flag = heretic_bastion } }
						change_variable = { which = church_bastion		value = 5 }
						set_variable = { which = church_bastion_local value = 0 }
						if = {
							limit = {
								check_variable = { which = religious_uprising value = 5 }
							}
							change_variable = { which = church_bastion_local value = 5 }
						}
						else_if = {
							limit = {
								check_variable = { which = religious_uprising value = 1 }
							}
							change_variable = { which = church_bastion_local which = religious_uprising }
						}
						subtract_variable = { which = church_bastion which = church_bastion_local }
						set_variable = { which = church_bastion_local value = 0 }
					}
					change_variable = { which = church_bastion		value = 5 }
					set_variable = { which = church_bastion_neighbor value = 0 }
					if = {
						limit = {
							any_neighbor_province = { check_variable = { which = religious_uprising value = 5 } }
						}
						set_variable = { which = church_bastion_neighbor value = 5 }
					}
					else_if = {
						limit = {
							any_neighbor_province = { check_variable = { which = religious_uprising value = 4 } }
						}
						set_variable = { which = church_bastion_neighbor value = 4 }
					}
					else_if = {
						limit = {
							any_neighbor_province = { check_variable = { which = religious_uprising value = 3 } }
						}
						set_variable = { which = church_bastion_neighbor value = 3 }
					}
					else_if = {
						limit = {
							any_neighbor_province = { check_variable = { which = religious_uprising value = 2 } }
						}
						set_variable = { which = church_bastion_neighbor value = 2 }
					}
					else_if = {
						limit = {
							any_neighbor_province = { check_variable = { which = religious_uprising value = 1 } }
						}
						set_variable = { which = church_bastion_neighbor value = 1 }
					}
					subtract_variable = { which = church_bastion which = church_bastion_neighbor }
					set_variable = { which = church_bastion_neighbor value = 0 }
				}
				capital_scope = {
					change_variable = { which = church_bastion value = 2 }
				}
				random_owned_province = { #Capital first if not heretic
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 5 }
						has_owner_religion = yes
						is_capital = yes
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 5 }
						has_owner_religion = yes
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 10 }
						any_neighbor_province = { check_variable = { which = church_bastion value = 10 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 9 }
						any_neighbor_province = { check_variable = { which = church_bastion value = 8.5 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 8 }
						any_neighbor_province = { check_variable = { which = church_bastion value = 7 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 7 }
						any_neighbor_province = { check_variable = { which = church_bastion value = 5.5 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 6 }
						any_neighbor_province = { check_variable = { which = church_bastion value = 4 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 5 }
						any_neighbor_province = { check_variable = { which = church_bastion value = 2.5 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 4 }
						any_neighbor_province = { check_variable = { which = church_bastion value = 1 } }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 3 }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 2 }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				random_owned_province = {
					limit = {
						owner = { check_variable = { which = church_bastion value = 1 } }
						check_variable = { which = church_bastion value = 1 }
						NOT = { has_province_flag = church_bastion }
						NOT = { has_province_flag = heretic_bastion }
						NOT = { any_neighbor_province = { has_province_flag = church_bastion } }
					}
					owner = { change_variable = { which = church_bastion value = -1 } }
					set_province_flag = church_bastion
				}
				#Tell interested players about this event
				#Same religion countries
				every_known_country = {
					limit = {
						ai = no
						OR = {
							AND = {
								is_neighbor_of = ROOT
								has_country_flag = religious_news_major
								OR = {
									is_rival = ROOT
									alliance_with = ROOT
									overlord_of = ROOT
									vassal_of = ROOT
									junior_union_with = ROOT
									truce_with = ROOT
									marriage_with = ROOT
									war_with = ROOT
								}
							}
							AND = {
								has_country_flag = religious_news_trivial
								OR = {
									is_rival = ROOT
									alliance_with = ROOT
									overlord_of = ROOT
									vassal_of = ROOT
									junior_union_with = ROOT
									is_neighbor_of = ROOT
									marriage_with = ROOT
									piety = 0.20
								}
							}
							has_country_flag = religious_news_all
						}
					}
					if = {
						limit = {
							religion = ROOT
						}
						set_country_flag = religious_war_government_notifier
						country_event = { id = dg_turmoil.066 days = 15 }
					}
					if = {
						limit = {
							PREV = { has_country_flag = religious_turmoil_hussite }
							religion = hussite
						}
						set_country_flag = religious_war_rebel_notifier
						country_event = { id = dg_turmoil.067 days = 15 }
					}
				}
				#Other countries
				every_known_country = {
					limit = {
						ai = no
						NOT = { has_country_flag = religious_war_rebel_notifier }
						NOT = { has_country_flag = religious_war_government_notifier }
						OR = {
							AND = {
								has_country_flag = religious_news_major
								OR = {
									war_with = ROOT
									vassal_of = ROOT
									overlord_of = ROOT
									junior_union_with = ROOT
								}
							}
							AND = {
								has_country_flag = religious_news_trivial
								OR = {
									is_rival = ROOT
									AND = {
										culture_group = ROOT
										religion_group = ROOT
									}
									AND = {
										is_neighbor_of = ROOT
										religion_group = ROOT
									}
									AND = {
										culture_group = ROOT
										religion_group = ROOT
									}
								}
							}
							AND = {
								has_country_flag = religious_news_all
								OR = {
									is_neighbor_of = ROOT
									culture_group = ROOT
									marriage_with = ROOT
								}
							}
						}
					}
					set_country_flag = religious_war_neighbor_notifier
					country_event = { id = dg_turmoil.068 days = 15 }
				}
			}
		}
	}
	
	option = {
		name = dg_hussite.021.a #Reject the demands
		ai_chance = {
			factor = 30
			modifier = {
				NOT = { legitimacy = 100 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 80 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 60 }
				factor = 1.4
			}
			modifier = {
				NOT = { legitimacy = 40 }
				factor = 1.4
			}
		}
		trigger = { NOT = { religion = hussite } }
		if = {
			limit = { NOT = { has_country_flag = hussite_wars_target } OR = { has_regency = no has_consort_regency = yes } }
			define_ruler = {
				regency = yes
				ADM = 0
				DIP = 0
				MIL = 0
			}
		}
		if = {
			limit = { has_heir = no }
			define_heir = { religion = catholic age = 12 }
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
			add_legitimacy = 8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
			add_legitimacy = 6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 2
			add_legitimacy = 2
		}
		if = {
			limit = { NOT = { has_country_flag = hussite_wars_target } }
			set_country_flag = internal_crusade
			set_country_flag = religious_turmoil_hussite
			set_country_flag = religious_turmoil_happening
			capital_scope = { set_province_flag = crusade_goal }
			force_converted = yes
			add_legitimacy = -25
			add_prestige = -25
			subtract_stability_2 = yes
			every_owned_province = {
				limit = { has_province_flag = heretic_bastion }
				add_province_modifier = { name = heretic_bastion duration = 3000 }
				hidden_effect = {
					set_variable = { which = rural_percentage_removed   value = 0.6 }
					remove_rural_population_DEVS = yes
					set_variable = { which = urban_percentage_removed   value = 0.3 }
					remove_urban_population_DEVS = yes
					change_variable = { which = hussite value = 6 }
					change_variable = { which = province_religion value = -6 }
				}
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				add_province_modifier = { name = church_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = heretic_bastion }
				spawn_rebels = { type = taborite_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					NOT = { has_province_flag = heretic_bastion }
					OR = {
						check_variable = { which = religious_uprising value = 4 }
						AND = {
							owner = { ai = no }
							check_variable = { which = religious_uprising value = 3 }
						}
					}
				}
				hidden_effect = {
					change_variable = { which = hussite value = 2 }
					change_variable = { which = province_religion value = -2 }
				}
				spawn_rebels = { type = taborite_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					NOT = { has_province_flag = heretic_bastion }
					NOT = { check_variable = { which = religious_uprising value = 4 } }
					OR = {
						owner = { ai = no }
						NOT = { check_variable = { which = religious_uprising value = 3 } }
					}
					check_variable = { which = religious_uprising value = 2 }
				}
				spawn_rebels = { type = taborite_rebels size = 0 }
			}
			every_owned_province = { #Must be done after rebels appear or the game does not obey this command
				limit = { has_province_flag = heretic_bastion }
				change_controller = REB
			}
			set_country_flag = hussite_wars_target
			PAP = { set_country_flag = hussite_wars }
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
	option = {
		name = dg_hussite.021.b #Accept the demands in return for my throne
		ai_chance = {
			factor = 10
			modifier = {
				NOT = { legitimacy = 100 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 80 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 60 }
				factor = 0.7
			}
			modifier = {
				NOT = { legitimacy = 40 }
				factor = 0
			}
		}
		trigger = { NOT = { religion = hussite } }
		set_country_flag = hussite_crown
		add_prestige = -25
		add_legitimacy = -25
		subtract_stability_2 = yes
		change_religion = hussite
		force_converted = yes
		if = {
			limit = { has_country_flag = hussite_war_ruler }
			set_ruler = hussite_war_ruler
			clr_country_flag = hussite_war_ruler
		}
		else = {
			define_ruler = { regency = no }
		}
		if = {
			limit = { has_country_flag = hussite_war_heir }
			set_heir = hussite_war_heir
			clr_country_flag = hussite_war_heir
		}
		hidden_effect = {
			set_country_flag = war_of_religion_lost
			every_owned_province = {
				clr_province_flag = heretic_bastion
				clr_province_flag = church_bastion
				remove_province_modifier = church_bastion
				remove_province_modifier = heretic_bastion
			}
			clr_country_flag = religious_civil_war
			clr_country_flag = bastion_fall_notifier
			clr_country_flag = religious_turmoil_hussite
			clr_country_flag = religious_turmoil_happening
		}
		capital_scope = {
			hidden_effect = {
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
			custom_tooltip = hussite_10
		}
		disband_rebels = hussite_rebels
		disband_rebels = taborite_rebels
		if = {
			limit = { NOT = { has_country_flag = hussite_wars_target } }
			set_country_flag = religious_civil_war
			set_country_flag = religious_turmoil_catholic
			set_country_flag = religious_turmoil_happening
			add_legitimacy = -50
			add_prestige = -50
			every_owned_province = {
				limit = { has_province_flag = heretic_bastion }
				add_province_modifier = { name = church_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				add_province_modifier = { name = heretic_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					NOT = { check_variable = { which = hussite value = 4 } }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					check_variable = { which = hussite value = 4 }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 0 }
			}
			set_country_flag = voluntary_conversion
			if = {
				limit = { NOT = { is_religion_enabled = hussite } }
				custom_tooltip = convert_dangerous_religion
				subtract_stability_1 = yes
			}
			if = {
				limit = { check_variable = { which = hussite_population value = 75 } }
				custom_tooltip = convert_population_75
				add_stability_1 = yes
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 50 } }
				custom_tooltip = convert_population_50
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 25 } }
				custom_tooltip = convert_population_25
				subtract_stability_1 = yes
			}
			else = {
				custom_tooltip = convert_population_0
				subtract_stability_2 = yes
			}
			if = {
				limit = { patriarch_authority = 0.75 }
				custom_tooltip = convert_church_strong
				subtract_stability_2 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.50 }
				custom_tooltip = convert_piety_moderate
				subtract_stability_1 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.25 }
				custom_tooltip = convert_church_weak
			}
			else = {
				custom_tooltip = convert_church_insignificant
			}
			if = {
				limit = { ADM = 5 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_strong
					add_stability_3 = yes
				}
				else = {
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
			}
			else_if = {
				limit = { ADM = 3 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
				else = {
					custom_tooltip = convert_ruler_incompetent
				}
			}
			if = {
				limit = { advisor = theologian }
				custom_tooltip = convert_theologian
				add_stability_1 = yes
			}
			if = {
				limit = {
					has_country_flag = was_hussite
				}
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_previous_recent
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_previous_old
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_recent
					add_stability_1 = yes
				}
			}
			change_religion = hussite
			force_converted = yes
			every_owned_province = { #Must be done after rebels appear or the game does not obey this command
				limit = { has_province_flag = church_bastion }
				change_controller = REB
			}
			set_country_flag = hussite_wars_target
			PAP = { set_country_flag = hussite_wars }
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
	option = {
		name = dg_hussite.021.c #Publish this document far and wide
		ai_chance = { factor = 20 }
		trigger = {
			religion = hussite
			NOT = { PAP = { has_country_flag = community_of_tabor } }
		}
		if = {
			limit = { has_heir = no }
			define_heir = { religion = hussite age = 12 }
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
			add_legitimacy = 8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
			add_legitimacy = 6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 2
			add_legitimacy = 2
		}
		capital_scope = {
			hidden_effect = {
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
			custom_tooltip = hussite_10
		}
		if = {
			limit = { NOT = { has_country_flag = hussite_wars_target } }
			set_country_flag = religious_civil_war
			set_country_flag = religious_turmoil_catholic
			set_country_flag = religious_turmoil_happening
			add_legitimacy = -50
			add_prestige = -50
			every_owned_province = {
				limit = { has_province_flag = heretic_bastion }
				add_province_modifier = { name = church_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				add_province_modifier = { name = heretic_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					NOT = { check_variable = { which = hussite value = 4 } }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					check_variable = { which = hussite value = 4 }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 0 }
			}
			set_country_flag = voluntary_conversion
			if = {
				limit = { NOT = { is_religion_enabled = hussite } }
				custom_tooltip = convert_dangerous_religion
				subtract_stability_1 = yes
			}
			if = {
				limit = { check_variable = { which = hussite_population value = 75 } }
				custom_tooltip = convert_population_75
				add_stability_1 = yes
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 50 } }
				custom_tooltip = convert_population_50
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 25 } }
				custom_tooltip = convert_population_25
				subtract_stability_1 = yes
			}
			else = {
				custom_tooltip = convert_population_0
				subtract_stability_2 = yes
			}
			if = {
				limit = { patriarch_authority = 0.75 }
				custom_tooltip = convert_church_strong
				subtract_stability_2 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.50 }
				custom_tooltip = convert_piety_moderate
				subtract_stability_1 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.25 }
				custom_tooltip = convert_church_weak
			}
			else = {
				custom_tooltip = convert_church_insignificant
			}
			if = {
				limit = { ADM = 5 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_strong
					add_stability_3 = yes
				}
				else = {
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
			}
			else_if = {
				limit = { ADM = 3 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
				else = {
					custom_tooltip = convert_ruler_incompetent
				}
			}
			if = {
				limit = { advisor = theologian }
				custom_tooltip = convert_theologian
				add_stability_1 = yes
			}
			if = {
				limit = {
					has_country_flag = was_hussite
				}
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_previous_recent
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_previous_old
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_recent
					add_stability_1 = yes
				}
			}
			change_religion = hussite
			force_converted = yes
			every_owned_province = { #Must be done after rebels appear or the game does not obey this command
				limit = { has_province_flag = church_bastion }
				change_controller = REB
			}
			set_country_flag = hussite_wars_target
			PAP = { set_country_flag = hussite_wars }
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
	option = {
		name = dg_hussite.021.e #Join the ranks of the Utraquists
		ai_chance = { factor = 30 }
		trigger = {
			religion = hussite
			PAP = { has_country_flag = community_of_tabor }
		}
		if = {
			limit = { has_heir = no }
			define_heir = { religion = hussite age = 12 }
		}
		if = {
			limit = { piety = 0.60 }
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = 0.20 }
			add_legitimacy = 3
		}
		else_if = {
			limit = { piety = -0.20 }
			add_legitimacy = 2
		}
		else_if = {
			limit = { piety = -0.60 }
			add_legitimacy = 1
		}
		add_stability_1 = yes
		add_ruler_modifier = { name = utraquist duration = -1 }
		set_country_flag = utraquist_faction
		add_country_modifier = { name = religious_tolerance duration = 1000 }
		define_advisor = { religion = hussite type = theologian discount = yes }
		capital_scope = {
			hidden_effect = {
				change_variable = { which = hussite value = 2 }
				change_variable = { which = province_religion value = -2 }
			}
			custom_tooltip = hussite_10
		}
		if = {
			limit = { NOT = { has_country_flag = hussite_wars_target } }
			set_country_flag = religious_civil_war
			set_country_flag = religious_turmoil_catholic
			set_country_flag = religious_turmoil_happening
			add_legitimacy = -50
			add_prestige = -50
			every_owned_province = {
				limit = { has_province_flag = heretic_bastion }
				add_province_modifier = { name = church_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				add_province_modifier = { name = heretic_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					NOT = { check_variable = { which = hussite value = 4 } }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					check_variable = { which = hussite value = 4 }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 0 }
			}
			set_country_flag = voluntary_conversion
			if = {
				limit = { NOT = { is_religion_enabled = hussite } }
				custom_tooltip = convert_dangerous_religion
				subtract_stability_1 = yes
			}
			if = {
				limit = { check_variable = { which = hussite_population value = 75 } }
				custom_tooltip = convert_population_75
				add_stability_1 = yes
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 50 } }
				custom_tooltip = convert_population_50
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 25 } }
				custom_tooltip = convert_population_25
				subtract_stability_1 = yes
			}
			else = {
				custom_tooltip = convert_population_0
				subtract_stability_2 = yes
			}
			if = {
				limit = { patriarch_authority = 0.75 }
				custom_tooltip = convert_church_strong
				subtract_stability_2 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.50 }
				custom_tooltip = convert_piety_moderate
				subtract_stability_1 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.25 }
				custom_tooltip = convert_church_weak
			}
			else = {
				custom_tooltip = convert_church_insignificant
			}
			if = {
				limit = { ADM = 5 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_strong
					add_stability_3 = yes
				}
				else = {
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
			}
			else_if = {
				limit = { ADM = 3 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
				else = {
					custom_tooltip = convert_ruler_incompetent
				}
			}
			if = {
				limit = { advisor = theologian }
				custom_tooltip = convert_theologian
				add_stability_1 = yes
			}
			if = {
				limit = {
					has_country_flag = was_hussite
				}
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_previous_recent
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_previous_old
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_recent
					add_stability_1 = yes
				}
			}
			change_religion = hussite
			force_converted = yes
			every_owned_province = { #Must be done after rebels appear or the game does not obey this command
				limit = { has_province_flag = church_bastion }
				change_controller = REB
			}
			set_country_flag = hussite_wars_target
			PAP = { set_country_flag = hussite_wars }
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
	option = {
		name = dg_hussite.021.f #Reject this apologist doctrine
		ai_chance = {
			factor = 10
			modifier = {
				NOT = { religious_unity = 0.80 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.60 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.40 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.20 }
				factor = 0
			}
		}
		trigger = {
			religion = hussite
			PAP = { has_country_flag = community_of_tabor }
		}
		if = {
			limit = { has_heir = no }
			define_heir = { age = 12 }
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 2
		}
		define_advisor = { religion = hussite type = inquisitor discount = yes }
		add_country_modifier = { name = religious_intolerance duration = 1000 }
		add_ruler_modifier = { name = taborite duration = -1 }
		set_country_flag = taborite_faction
		if = {
			limit = { NOT = { has_country_flag = hussite_wars_target } }
			set_country_flag = religious_civil_war
			set_country_flag = religious_turmoil_catholic
			set_country_flag = religious_turmoil_happening
			add_legitimacy = -50
			add_prestige = -50
			every_owned_province = {
				limit = { has_province_flag = heretic_bastion }
				add_province_modifier = { name = church_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				add_province_modifier = { name = heretic_bastion duration = 3000 }
			}
			every_owned_province = {
				limit = { has_province_flag = church_bastion }
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					NOT = { check_variable = { which = hussite value = 4 } }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 1 }
			}
			every_owned_province = {
				limit = {
					religion = catholic
					check_variable = { which = hussite value = 4 }
					is_city = yes
					is_core = ROOT
				}
				spawn_rebels = { type = catholic_rebels size = 0 }
			}
			set_country_flag = voluntary_conversion
			if = {
				limit = { NOT = { is_religion_enabled = hussite } }
				custom_tooltip = convert_dangerous_religion
				subtract_stability_1 = yes
			}
			if = {
				limit = { check_variable = { which = hussite_population value = 75 } }
				custom_tooltip = convert_population_75
				add_stability_1 = yes
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 50 } }
				custom_tooltip = convert_population_50
			}
			else_if = {
				limit = { check_variable = { which = hussite_population value = 25 } }
				custom_tooltip = convert_population_25
				subtract_stability_1 = yes
			}
			else = {
				custom_tooltip = convert_population_0
				subtract_stability_2 = yes
			}
			if = {
				limit = { patriarch_authority = 0.75 }
				custom_tooltip = convert_church_strong
				subtract_stability_2 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.50 }
				custom_tooltip = convert_piety_moderate
				subtract_stability_1 = yes
			}
			else_if = {
				limit = { patriarch_authority = 0.25 }
				custom_tooltip = convert_church_weak
			}
			else = {
				custom_tooltip = convert_church_insignificant
			}
			if = {
				limit = { ADM = 5 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_strong
					add_stability_3 = yes
				}
				else = {
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
			}
			else_if = {
				limit = { ADM = 3 }
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_moderate
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						capital_scope = { religion = hussite }
					}
					custom_tooltip = convert_ruler_weak
					add_stability_1 = yes
				}
				else = {
					custom_tooltip = convert_ruler_incompetent
				}
			}
			if = {
				limit = { advisor = theologian }
				custom_tooltip = convert_theologian
				add_stability_1 = yes
			}
			if = {
				limit = {
					has_country_flag = was_hussite
				}
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_previous_recent
					add_stability_2 = yes
				}
				else = {
					custom_tooltip = convert_previous_old
					add_stability_1 = yes
				}
			}
			else = {
				if = {
					limit = {
						check_variable = { which = sympathy_to_old_religion value = 1 }
					}
					custom_tooltip = convert_recent
					add_stability_1 = yes
				}
			}
			change_religion = hussite
			force_converted = yes
			every_owned_province = { #Must be done after rebels appear or the game does not obey this command
				limit = { has_province_flag = church_bastion }
				change_controller = REB
			}
			set_country_flag = hussite_wars_target
			PAP = { set_country_flag = hussite_wars }
		}
		hidden_effect = {
			every_owned_province = { set_variable = { which = religious_uprising value = 0 } }
			every_owned_province = { set_variable = { which = church_bastion value = 0 } }
		}
	}
}

province_event = { #The Community of Tabor (1420)
	
	id = dg_hussite.022
	title = dg_hussite.022.t
	desc = dg_hussite.022.d
	picture = hussite_wars
	
	trigger = {
		owner = { has_country_flag = hussite_wars_target }
		PAP = { had_country_flag = { flag = hussite_wars days = 400 } }
		check_variable = { which = hussite value = 4 }
		NOT = { PAP = { has_country_flag = community_of_tabor } }
		NOT = { has_province_modifier = heretic_bastion }
		NOT = { has_province_modifier = church_bastion }
		is_capital = no
	}
	
	mean_time_to_happen = {
		
		months = 25
		
		modifier = {
			owner = {
				NOT = { religion = hussite }
				num_of_owned_provinces_with = {
					has_province_modifier = heretic_bastion
					value = 2
				}
			}
			factor = 2
		}
		modifier = {
			owner = {
				NOT = { religion = hussite }
				any_owned_province = {
					has_province_modifier = heretic_bastion
					controlled_by = REB
					has_siege = yes
				}
			}
			factor = 0.1
		}
		modifier = {
			owner = {
				NOT = { religion = hussite }
				NOT = { has_spawned_rebels = taborite_rebels }
				NOT = { has_spawned_rebels = hussite_rebels }
			}
			factor = 0.1
		}
		modifier = {
			owner = {
				religion = hussite
				at_war_with_religious_enemy = yes
			}
			factor = 0.1
		}
	}
	
	immediate = {
		hidden_effect = {
			PAP = { set_country_flag = community_of_tabor }
			set_province_flag = tabor
		}
	}
	
	option = {
		name = dg_hussite.022.a #They must be put down like rabid dogs
		trigger = { owner = { NOT = { religion = hussite } } }
		ai_chance = { factor = 50 }
		add_province_modifier = { name = heretic_bastion duration = 3000 }
		if = {
			limit = { owner = { num_of_rebel_controlled_provinces = 1 } }
			spawn_rebels = { type = taborite_rebels size = 1 }
		}
		if = {
			limit = { owner = { NOT = { num_of_rebel_controlled_provinces = 1 } } }
			spawn_rebels = { type = taborite_rebels size = 2 }
		}
		change_controller = REB
	}
	option = {
		name = dg_hussite.022.b #Welcome these new allies cautiously
		trigger = {
			owner = { religion = hussite }
			NOT = { is_religion_enabled = hussite }
		}
		ai_chance = { factor = 10 }
		owner = {
			add_manpower = 5
			add_war_exhaustion = -2
		}
	}
	option = {
		name = dg_hussite.022.e #Accept their aid but reject their doctrines
		trigger = {
			owner = { religion = hussite }
			is_religion_enabled = hussite
		}
		ai_chance = { factor = 30 }
		owner = {
			add_manpower = 5
			add_war_exhaustion = -2
			add_stability_1 = yes
			define_advisor = { religion = hussite type = theologian discount = yes }
			add_ruler_modifier = { name = utraquist duration = -1 }
			set_country_flag = utraquist_faction
			add_country_modifier = { name = religious_tolerance duration = 1000 }
		}
	}
	option = {
		name = dg_hussite.022.c #Embrace the Taborite cause as our own
		trigger = {
			owner = { religion = hussite }
			is_religion_enabled = hussite
		}
		ai_chance = {
			factor = 10
			modifier = {
				NOT = { owner = { religious_unity = 0.80 } }
				factor = 0.7
			}
			modifier = {
				NOT = { owner = { religious_unity = 0.60 } }
				factor = 0.7
			}
			modifier = {
				NOT = { owner = { religious_unity = 0.40 } }
				factor = 0.7
			}
			modifier = {
				NOT = { owner = { religious_unity = 0.20 } }
				factor = 0
			}
		}
		owner = {
			add_manpower = 5
			add_war_exhaustion = -2
			add_ruler_modifier = { name = taborite duration = -1 }
			set_country_flag = taborite_faction
			add_country_modifier = { name = religious_intolerance duration = 1000 }
			define_advisor = { religion = hussite type = inquisitor discount = yes }
		}
	}
}

province_event = { #Hussite Confederation
	
	id = dg_hussite.023
	title = dg_hussite.023.t
	desc = dg_hussite.023.d
	picture = hussite_barons
	
	trigger = {
		NOT = { religion_years = { hussite = 10 } }
		PAP = { has_country_flag = lollardy_banned }
		religion = catholic
		OR = {
			owner = { hussite = -1 }
			owner = { NOT = { religion = catholic } }
		}
		any_neighbor_province = { any_neighbor_province = { any_neighbor_province = { check_variable = { which = hussite value = 6 } } } }
		NOT = { owner = { any_owned_province = { check_variable = { which = hussite value = 2 } } } }
		NOT = { owner = { has_country_flag = hussite_persecution } }
		NOT = { owner = { has_country_flag = hussite_confederation } }
	}
	
	mean_time_to_happen = { months = 10 }
	
	option = {
		name = dg_hussite.023.a #Persecute them
		ai_chance = {
			factor = 60
			modifier = {
				is_part_of_hre = yes
				factor = 1.4
			}
			modifier = {
				owner = {
					any_rival_country = {
						has_country_flag = hussite_wars_target
					}
				}
				factor = 0.7
			}
			modifier = {
				owner = {
					any_enemy_country = {
						has_country_flag = hussite_wars_target
					}
				}
				factor = 0.5
			}
			modifier = {
				owner = {
					any_ally = {
						has_country_flag = hussite_wars_target
					}
				}
				factor = 1.4
			}
			modifier = {
				owner = {
					any_subject_country = {
						has_country_flag = hussite_wars_target
					}
				}
				factor = 1.4
			}
			modifier = {
				owner = { NOT = { religion = catholic } }
				factor = 0.5
			}
			modifier = {
				owner = { hussite = -1 }
				factor = 1.4
			}
			modifier = {
				owner = { hussite = 0 }
				factor = 0.7
			}
			modifier = {
				owner = { hussite = 1 }
				factor = 0.7
			}
			modifier = {
				owner = { hussite = 2 }
				factor = 0.7
			}
			modifier = {
				owner = { hussite = 3 }
				factor = 0.7
			}
			modifier = {
				owner = { NOT = { religious_unity = 0.80 } }
				factor = 0.7
			}
			modifier = {
				owner = { NOT = { religious_unity = 0.60 } }
				factor = 0.7
			}
			modifier = {
				owner = { NOT = { religious_unity = 0.40 } }
				factor = 0.7
			}
			modifier = {
				owner = { NOT = { religious_unity = 0.20 } }
				factor = 0
			}
		}
		custom_tooltip = hussite_10
		hidden_effect = {
			change_variable = { which = hussite value = 2 }
			change_variable = { which = catholic value = -2 }
		}
		owner = {
			hidden_effect = { set_country_flag = hussite_persecution }
			every_neighbor_country = {
				limit = {
					OR = {
						has_country_flag = hussite_confederation
						has_country_flag = lollard_sympathy
					}
				}
				add_opinion = { who = ROOT modifier = mistreated_coreligionists_observant }
			}
			every_neighbor_country = {
				limit = { religion = hussite }
				add_opinion = { who = ROOT modifier = mistreated_coreligionists_pious }
			}
			if = {
				limit = {
					NOT = { has_country_modifier = religious_tolerance }
					NOT = { has_country_modifier = religious_intolerance }
				}
				add_piety = 0.20
				add_country_modifier = { name = religious_intolerance duration = 1000 }
			}
			if = {
				limit = { has_country_modifier = religious_tolerance }
				add_piety = 0.40
				remove_country_modifier = religious_tolerance
				add_country_modifier = { name = religious_intolerance duration = 1000 }
			}
		}
	}
	option = {
		name = dg_hussite.023.b #Tolerate them
		ai_chance = { factor = 40 }
		custom_tooltip = hussite_20
		hidden_effect = {
			change_variable = { which = hussite value = 4 }
			change_variable = { which = catholic value = -4 }
		}
		owner = {
			set_country_flag = hussite_confederation
			random_known_country = {
				limit = {
					has_country_flag = hussite_wars_target
					NOT = { religion = hussite }
				}
				reverse_add_opinion = { who = ROOT modifier = mistreated_coreligionists_pious }
			}
			random_known_country = {
				limit = {
					has_country_flag = hussite_wars_target
					religion = hussite
				}
				add_opinion = { who = ROOT modifier = aided_coreligionists_pious }
			}
			if = {
				limit = {
					NOT = { has_country_modifier = religious_tolerance }
					NOT = { has_country_modifier = religious_intolerance }
				}
				add_piety = -0.20
				add_country_modifier = { name = religious_tolerance duration = 1000 }
			}
			if = {
				limit = { has_country_modifier = religious_intolerance }
				add_piety = -0.40
				remove_country_modifier = religious_intolerance
				add_country_modifier = { name = religious_tolerance duration = 1000 }
			}
		}
	}
}

country_event = { #The Hussite Crown
	
	id = dg_hussite.024
	title = dg_hussite.024.t
	desc = dg_hussite.024.d
	picture = catholic_court
	
	trigger = {
		has_country_flag = hussite_wars_target
		has_country_flag = internal_crusade
		PAP = { has_country_flag = hussite_wars }
		NOT = { PAP = { has_country_flag = hussite_crown_offered } }
		religion = catholic
		capital_scope = {
			controlled_by = REB
		}
		any_known_country = {
			has_country_flag = hussite_confederation
			government = monarchy
			OR = { has_regency = no has_consort_regency = yes }
		}
	}
	
	mean_time_to_happen = { months = 50 }
	
	immediate = {
		add_legitimacy = -10
		hidden_effect = {
			PAP = { set_country_flag = hussite_crown_offered }
			#Choosing an appropriate target
			random_known_country = {
				limit = {
					has_country_flag = hussite_confederation
					government = monarchy
					OR = { has_regency = no has_consort_regency = yes }
					religion_group = christian
					OR = {
						num_of_cities = ROOT
						army_size = ROOT
					}
				}
				set_country_flag = hussite_crown
			}
			if = {
				limit = { NOT = { any_known_country = { has_country_flag = hussite_crown } } }
				random_known_country = {
					limit = {
						has_country_flag = hussite_confederation
						government = monarchy
						OR = { has_regency = no has_consort_regency = yes }
						religion_group = christian
						OR = {
							is_rival = ROOT
							is_enemy = ROOT
						}
					}
					set_country_flag = hussite_crown
				}
			}
			if = {
				limit = { NOT = { any_known_country = { has_country_flag = hussite_crown } } }
				random_known_country = {
					limit = {
						has_country_flag = hussite_confederation
						government = monarchy
						OR = { has_regency = no has_consort_regency = yes }
						religion_group = christian
						culture_group = ROOT
					}
					set_country_flag = hussite_crown
				}
			}
			if = {
				limit = { NOT = { any_known_country = { has_country_flag = hussite_crown } } }
				random_known_country = {
					limit = {
						has_country_flag = hussite_confederation
						government = monarchy
						OR = { has_regency = no has_consort_regency = yes }
					}
					set_country_flag = hussite_crown
				}
			}
		}
	}
	
	option = {
		name = dg_hussite.024.a #Fight with words
		ai_chance = {
			factor = 50
			modifier = {
				any_known_country = {
					has_country_flag = hussite_crown
					OR = {
						num_of_cities = ROOT
						army_size = ROOT
					}
				}
				factor = 2
			}
			modifier = {
				any_rival_country = {
					has_country_flag = hussite_crown
				}
				factor = 0.7
			}
			modifier = {
				any_enemy_country = {
					has_country_flag = hussite_crown
				}
				factor = 0.5
			}
		}
		custom_tooltip = hussite_union
		random_known_country = {
			limit = { has_country_flag = hussite_crown }
			add_opinion = { who = ROOT modifier = hussite_crown_offered }
			country_event = { id = dg_hussite.025 } #
		}
	}
	option = {
		name = dg_hussite.024.b #Fight with guns
		ai_chance = { factor = 50 }
		random_owned_province = {
			limit = {
				controlled_by = ROOT
				NOT = { units_in_province = 1 }
			}
			spawn_rebels = {
				type = pretender_rebels
				culture = ROOT
				religion = ROOT
				size = 2
			}
		}
		random_known_country = {
			limit = { has_country_flag = hussite_crown }
			add_opinion = { who = ROOT modifier = hussite_crown_refused }
			add_casus_belli = { target = ROOT type = cb_restore_personal_union months = 60 }
			country_event = { id = dg_hussite.026 } #
		}
	}
}

country_event = { #The Hussite Crown
	
	id = dg_hussite.025
	title = dg_hussite.025.t
	desc = dg_hussite.025.d
	picture = catholic_court
	
	is_triggered_only = yes
	
	option = {
		name = dg_hussite.025.a #Allow the coronation
		trigger = {
			is_lesser_in_union = no
			FROM = { is_lesser_in_union = no }
		}
		ai_chance = {
			factor = 50
			modifier = {
				piety = 0.20
				factor = 0.7
			}
			modifier = {
				piety = 0.60
				factor = 0.7
			}
			modifier = {
				NOT = { piety = -0.20 }
				factor = 1.4
			}
			modifier = {
				NOT = { piety = -0.60 }
				factor = 1.4
			}
			modifier = {
				has_country_modifier = religious_intolerance
				factor = 0.7
			}
			modifier = {
				has_country_modifier = religious_tolerance
				factor = 1.4
			}
		}
		white_peace = FROM
		create_union = FROM
		add_legitimacy = -25
		add_prestige = -25
		FROM = { country_event = { id = dg_hussite.027 days = 30 } }
	}
	option = {
		name = dg_hussite.025.b #Forbid the coronation
		ai_chance = { factor = 50 }
		hidden_effect = { set_country_flag = hussite_crown_refused }
		FROM = {
			define_ruler = { religion = catholic dynasty = ROOT }
			add_casus_belli = { target = ROOT months = 36 type = cb_insult }
			country_event = { id = dg_hussite.027 days = 30 }
		}
		every_owned_province = {
			if = {
				limit = { check_variable = { which = hussite value = 10 } }
				hidden_effect = {
					set_variable = { which = added_unrest value = 5 }
					add_base_unrest = yes
				}
				custom_tooltip = added_unrest_5
			}
			else_if = {
				limit = { check_variable = { which = hussite value = 8 } }
				hidden_effect = {
					set_variable = { which = added_unrest value = 4 }
					add_base_unrest = yes
				}
				custom_tooltip = added_unrest_4
			}
			else_if = {
				limit = { check_variable = { which = hussite value = 6 } }
				hidden_effect = {
					set_variable = { which = added_unrest value = 3 }
					add_base_unrest = yes
				}
				custom_tooltip = added_unrest_3
			}
			else_if = {
				limit = { check_variable = { which = hussite value = 4 } }
				hidden_effect = {
					set_variable = { which = added_unrest value = 2 }
					add_base_unrest = yes
				}
				custom_tooltip = added_unrest_2
			}
			else_if = {
				limit = { check_variable = { which = hussite value = 2 } }
				hidden_effect = {
					set_variable = { which = added_unrest value = 1 }
					add_base_unrest = yes
				}
				custom_tooltip = added_unrest_1
			}
		}
	}
}

country_event = { #The Hussite Crown
	
	id = dg_hussite.026
	title = dg_hussite.026.t
	desc = dg_hussite.026.d
	picture = catholic_court
	
	is_triggered_only = yes
	
	option = {
		name = dg_hussite.026.a #This is a slap in the face
		add_prestige = -10
		add_legitimacy = 10
		add_casus_belli = { target = FROM type = cb_restore_personal_union months = 60 }
	}
}

country_event = { #Foreign Intervention
	
	id = dg_hussite.027
	title = dg_hussite.027.t
	desc = dg_hussite.027.d
	picture = catholic_court
	
	is_triggered_only = yes
	
	option = {
		name = dg_hussite.027.a #Peace at last!
		hidden_effect = {
			set_country_flag = war_of_religion_lost
			set_country_flag = hussite_crown
		}
		every_owned_province = {
			limit = {
				controlled_by = REB
				NOT = { has_province_flag = community_of_tabor }
			}
			change_controller = ROOT
		}
		if = {
			limit = { has_country_flag = religious_turmoil_catholic }
			disband_rebels = catholic_rebels
			hidden_effect = { clr_country_flag = religious_turmoil_catholic }
		}
		if = {
			limit = { has_country_flag = religious_turmoil_hussite }
			disband_rebels = hussite_rebels
			hidden_effect = { clr_country_flag = religious_turmoil_hussite }
			disband_rebels = taborite_rebels
		}
		hidden_effect = {
			every_owned_province = {
				clr_province_flag = heretic_bastion
				clr_province_flag = church_bastion
				remove_province_modifier = church_bastion
				remove_province_modifier = heretic_bastion
			}
			clr_country_flag = religious_civil_war
			clr_country_flag = bastion_fall_notifier
			clr_country_flag = internal_crusade
		}
		add_prestige = -10
		if = {
			limit = { NOT = { stability = 0 } }
			add_stability_1 = yes
		}
	}
}

country_event = { #International Pressure (1423)
	
	id = dg_hussite.028
	title = dg_hussite.028.t
	desc = dg_hussite.028.d
	picture = catholic_trial
	
	trigger = {
		has_country_flag = hussite_crown
		is_emperor = no
		is_papal_controller = no
		NOT = {
			any_known_country = {
				has_country_flag = hussite_crown
				OR = {
					is_emperor = yes
					is_papal_controller = yes
				}
				OR = {
					NOT = { is_enemy = ROOT }
					AND = {
						is_emperor = yes
						is_papal_controller = yes
					}
				}
			}
		}
	}
	
	mean_time_to_happen = { months = 10 }
	
	immediate = { hidden_effect = { clr_country_flag = hussite_crown } }
	
	option = {
		name = dg_hussite.028.a #Withdraw our candidate from their throne
		trigger = { NOT = { has_country_flag = hussite_wars_target } }
		ai_chance = {
			factor = 30
			modifier = {
				has_country_flag = hussite_crown_refused
				factor = 2
			}
		}
		add_prestige = -10
		if = {
			limit = { NOT = { has_country_flag = hussite_crown_refused } }
			random_known_country = {
				limit = { has_country_flag = hussite_wars_target }
				hidden_effect = { clr_country_flag = hussite_crown }
				break_union = ROOT
				kill_ruler = yes
			}
		}
	}
	option = {
		name = dg_hussite.028.b #Leave the $PRIMARY_CULTURE$ throne
		trigger = { has_country_flag = hussite_wars_target }
		ai_chance = {
			factor = 30
			modifier = {
				NOT = { any_known_country = { has_country_flag = hussite_crown NOT = { tag = ROOT } } }
				factor = 2
			}
		}
		add_prestige = -10
		random_known_country = {
			limit = { has_country_flag = hussite_crown }
			break_union = ROOT
			hidden_effect = { clr_country_flag = hussite_crown }
		}
		kill_ruler = yes
	}
	option = {
		name = dg_hussite.028.c #Refuse to bend to their demands
		ai_chance = {
			factor = 40
			modifier = {
				NOT = { religion = catholic }
				factor = 2
			}
		}
		if = {
			limit = { religion = catholic }
			add_legitimacy = -25
		}
		hidden_effect = { set_country_flag = excommunication_unjust_war }
		every_country = {
			limit = {
				religion = catholic
				OR = {
					is_neighbor_of = ROOT
					is_papal_controller = yes
					is_emperor = yes
					piety = 1.00
				}
			}
			add_casus_belli = { target = ROOT type = cb_insult months = 60 }
		}
	}
}

country_event = { #Civil War (1423)
	
	id = dg_hussite.029
	title = dg_hussite.029.t
	desc = dg_hussite.029.d
	picture = all_massacre
	
	trigger = {
		has_country_flag = hussite_wars_target
		NOT = { had_country_flag = { flag = hussite_wars_target days = 2000 } }
		has_regency = no
		OR = {
			NOT = { has_country_flag = hussite_crown }
			has_country_flag = religious_turmoil_catholic
			has_country_flag = religious_turmoil_hussite
			has_country_modifier = religious_intolerance
		}
		NOT = { has_country_flag = religious_civil_war }
		NOT = { has_country_flag = hussite_wars_second_phase }
		any_owned_province = { has_owner_religion = no has_owner_culture = yes }
		NOT = { religious_unity = 0.90 }
	}
	
	
	mean_time_to_happen = { months = 1 }
	
	immediate = {
		hidden_effect = {
			set_country_flag = internal_crusade
			capital_scope = { set_province_flag = crusade_goal }
			set_country_flag = hussite_wars_second_phase
		}
	}
	
	option = {
		name = dg_hussite.029.a #Let us finish this
		if = {
			limit = { piety = 0.60 }
			add_legitimacy = 8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_legitimacy = 6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = -0.60 }
			add_legitimacy = 2
		}
		hidden_effect = {
			set_country_flag = religious_turmoil_happening
			if = {
				limit = { religion = catholic }
				set_country_flag = religious_turmoil_hussite
			}
			else_if = {
				limit = { religion = hussite }
				set_country_flag = religious_turmoil_catholic
			}
		}
		country_event = { id = dg_turmoil.041 }
	}
}

country_event = { #Hussite Offensive
	
	id = dg_hussite.030
	title = dg_hussite.030.t
	desc = dg_hussite.030.d
	picture = hussite_wagons
	
	trigger = {
		has_country_flag = hussite_wars_target
		NOT = { has_country_flag = hussite_offensive }
		has_country_flag = religious_civil_war
		OR = {
			has_country_flag = religious_turmoil_catholic
			has_country_flag = religious_turmoil_hussite
		}
		OR = {
			religion = catholic
			religion = hussite
		}
		OR = {
			NOT = { has_country_flag = internal_crusade }
			has_country_flag = hussite_wars_second_phase
		}
	}
	
	mean_time_to_happen = {
		
		months = 25
		
		modifier = {
			NOT = { religion = hussite }
			num_of_owned_provinces_with = {
				has_province_modifier = heretic_bastion
				value = 2
			}
			factor = 2
		}
		modifier = {
			NOT = { religion = hussite }
			any_owned_province = {
				has_province_modifier = heretic_bastion
				controlled_by = REB
				has_siege = yes
			}
			factor = 0.1
		}
		modifier = {
			NOT = { religion = hussite }
			NOT = { has_spawned_rebels = taborite_rebels }
			NOT = { has_spawned_rebels = hussite_rebels }
			factor = 0.1
		}
		modifier = {
			religion = hussite
			at_war_with_religious_enemy = yes
			factor = 0.1
		}
	}
	
	immediate = { hidden_effect = { set_country_flag = hussite_offensive } }
	
	option = {
		name = dg_hussite.030.a #They have shown their true colors
		trigger = { NOT = { religion = hussite } }
		ai_chance = { factor = 40 }
		add_war_exhaustion = 1
		random_owned_province = {
			limit = { controlled_by = owner check_variable = { which = hussite value = 2 } }
			add_province_modifier = { name = heretic_bastion duration = 3000 }
			spawn_rebels = { type = taborite_rebels size = 1 }
			change_controller = REB
		}
	}
	option = {
		name = dg_hussite.030.b #Give them free rein
		trigger = { religion = hussite }
		ai_chance = {
			factor = 30
			modifier = {
				has_country_modifier = utraquist
				factor = 0.5
			}
			modifier = {
				has_country_modifier = taborite
				factor = 2
			}
			modifier = {
				num_of_loans = 1
				factor = 1.4
			}
			modifier = {
				num_of_loans = 2
				factor = 1.4
			}
			modifier = {
				is_bankrupt = yes
				factor = 2
			}
			modifier = {
				war_exhaustion = 5
				factor = 1.4
			}
			modifier = {
				war_exhaustion = 10
				factor = 1.4
			}
			modifier = {
				war_exhaustion = 15
				factor = 1.4
			}
			modifier = {
				war_exhaustion = 20
				factor = 1.4
			}
		}
	}
	option = {
		name = dg_hussite.030.c #Keep them under control
		trigger = { religion = hussite }
		ai_chance = { factor = 30 }
		hidden_effect = { set_country_flag = limited_hussite_raids }
		add_war_exhaustion = 2
		add_yearly_manpower = 0.05
	}
}

province_event = { #Hussite Raids
	
	id = dg_hussite.031
	title = dg_hussite.031.t
	desc = dg_hussite.031.d
	picture = hussite_wagons
	
	trigger = {
		owner = {
			any_known_country = {
				has_country_flag = hussite_offensive
				OR = {
					has_country_flag = religious_civil_war
					has_country_flag = crusade_target
				}
			}
		}
		is_religion_enabled = hussite
		NOT = { is_religion_enabled = protestant }
		PAP = { has_country_flag = hussite_wars }
		religion = catholic
		NOT = { owner = { religion = hussite } }
		NOT = { check_variable = { which = hussite_raids value = 2 } }
		NOT = { has_province_modifier = hussite_raids }
		OR = {
			NOT = { check_variable = { which = hussite_raids value = 1 } }
			AND = {
				owner = { has_country_flag = supported_hussite_crusade }
				NOT = { check_variable = { which = hussite_raids value = 3 } }
			}
		}
		OR = {
			AND = {
				check_variable = { which = hussite value = 2 }
				NOT = { culture = english }
			}
			any_neighbor_province = { check_variable = { which = hussite value = 4 } NOT = { culture = english } }
			any_neighbor_province = { any_neighbor_province = { check_variable = { which = hussite value = 8 } NOT = { culture = english } } }
			any_neighbor_province = { any_neighbor_province = { any_neighbor_province = { check_variable = { which = hussite value = 12 } NOT = { culture = english } } } }
		}
	}
	
	mean_time_to_happen = {
		
		years = 8
		
		modifier = {
			check_variable = { which = hussite value = 2 }
			factor = 0.7
		}
		modifier = {
			any_neighbor_province = { check_variable = { which = hussite value = 4 } }
			factor = 0.7
		}
		modifier = {
			any_neighbor_province = { check_variable = { which = hussite value = 8 } }
			factor = 0.7
		}
		modifier = {
			any_neighbor_province = { check_variable = { which = hussite value = 12 } }
			factor = 0.7
		}
		modifier = {
			owner = { has_country_flag = supported_hussite_crusade }
			factor = 0.5
		}
		modifier = {
			check_variable = { which = hussite_raids value = 1 }
			factor = 2
		}
	}
	
	immediate = { hidden_effect = { change_variable = { which = hussite_raids value = 1 } } }
	
	option = {
		name = dg_hussite.031.a #Blast those brigands!
		owner = {
			add_treasury = -5
			random_known_country = {
				limit = { has_country_flag = hussite_offensive religion = hussite }
				add_treasury = 5
				reverse_add_opinion = { who = ROOT modifier = hussite_raid_sponsor }
			}
			if = {
				limit = {
					NOT = { num_of_cities = 12 }
					NOT = { check_variable = { which = hussite_raids value = 2 } }
				}
				add_war_exhaustion = 1
			}
			if = {
				limit = {
					NOT = { num_of_cities = 4 }
				}
				add_war_exhaustion = 0.5
			}
		}
		if = {
			limit = { any_neighbor_province = { check_variable = { which = hussite value = 4 } } }
			add_province_modifier = { name = hussite_raids duration = 1600 }
		}
		if = {
			limit = {
				NOT = { any_neighbor_province = { check_variable = { which = hussite value = 4 } } }
				any_neighbor_province = { any_neighbor_province = { check_variable = { which = hussite value = 4 } } }
			}
			add_province_modifier = { name = hussite_raids duration = 800 }
		}
		if = {
			limit = {
				NOT = { any_neighbor_province = { check_variable = { which = hussite value = 4 } } }
				NOT = { any_neighbor_province = { any_neighbor_province = { check_variable = { which = hussite value = 4 } } } }
				any_neighbor_province = { any_neighbor_province = { any_neighbor_province = { check_variable = { which = hussite value = 4 } } } }
			}
			add_province_modifier = { name = hussite_raids duration = 400 }
		}
	}
}

country_event = { #Noble Turncoats
	
	id = dg_hussite.032
	title = dg_hussite.032.t
	desc = dg_hussite.032.d
	picture = hussite_barons
	
	trigger = {
		has_country_flag = hussite_wars_target
		had_country_flag = { flag = hussite_wars_target days = 1000 }
		has_country_flag = religious_civil_war
		OR = {
			has_country_flag = religious_turmoil_hussite
			has_country_flag = religious_turmoil_catholic
		}
		NOT = { has_country_flag = hussite_turncoats }
		NOT = { is_religion_enabled = protestant }
		OR = {
			AND = {
				religion = catholic
				num_of_owned_provinces_with = {
					controlled_by = REB
					value = 3
				}
			}
			AND = {
				religion = hussite
				NOT = {
					num_of_owned_provinces_with = {
						controlled_by = REB
						value = 4
					}
				}
			}
		}
	}
	
	mean_time_to_happen = { months = 5 }
	
	immediate = { hidden_effect = { set_country_flag = hussite_turncoats } }
	
	option = {
		name = dg_hussite.032.a #Let them keep their stolen property
		ai_chance = { factor = 45 }
		trigger = { religion = catholic }
		if = {
			limit = { check_variable = { which = church_property value = 1 } }
			hidden_effect = { change_variable = { which = church_property value = -1 } }
			add_patriarch_authority = -0.05
		}
		if = {
			limit = {
				NOT = { has_country_modifier = religious_tolerance }
				NOT = { has_country_modifier = religious_intolerance }
			}
			add_piety = -0.20
			add_country_modifier = { name = religious_tolerance duration = 1000 }
		}
		if = {
			limit = { has_country_modifier = religious_intolerance }
			add_piety = -0.40
			remove_country_modifier = religious_intolerance
			add_country_modifier = { name = religious_tolerance duration = 1000 }
		}
		if = {
			limit = { piety = 0.60 }
			add_legitimacy = -8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_legitimacy = -6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_legitimacy = -4
		}
		else = {
			add_legitimacy = -2
		}
		add_war_exhaustion = -1
		add_manpower = 1
		random_owned_province = {
			limit = {
				controlled_by = REB
				has_province_modifier = heretic_bastion
			}
			change_controller = ROOT
			remove_province_modifier = heretic_bastion
		}
		random_owned_province = {
			limit = {
				controlled_by = REB
				NOT = { has_province_modifier = heretic_bastion }
			}
			change_controller = ROOT
		}
	}
	option = {
		name = dg_hussite.032.b #Demand absolute submission
		ai_chance = { factor = 5 }
		trigger = { religion = catholic }
		if = {
			limit = {
				NOT = { has_country_modifier = religious_tolerance }
				NOT = { has_country_modifier = religious_intolerance }
			}
			add_piety = 0.20
			add_country_modifier = { name = religious_intolerance duration = 1000 }
		}
		if = {
			limit = { has_country_modifier = religious_tolerance }
			add_piety = 0.40
			remove_country_modifier = religious_tolerance
			add_country_modifier = { name = religious_intolerance duration = 1000 }
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
		}
		else = {
			add_prestige = 2
		}
	}
	option = {
		name = dg_hussite.032.c #They shall regret this betrayal
		ai_chance = { factor = 50 }
		trigger = { religion = hussite }
		if = {
			limit = { has_country_modifier = religious_tolerance }
			remove_country_modifier = religious_tolerance
			add_piety = 0.20
		}
		random_owned_province = {
			limit = { religion = catholic NOT = { controlled_by = REB } }
			add_province_modifier = { name = heretic_bastion duration = 3000 }
			spawn_rebels = { type = catholic_rebels size = 1 }
			change_controller = REB
		}
	}
}

country_event = { #The Assembly of $CAPITAL_CITY$
	
	id = dg_hussite.033
	title = dg_hussite.033.t
	desc = dg_hussite.033.d
	picture = hussite_barons
	
	trigger = {
		has_country_flag = hussite_wars_target
		NOT = { has_country_flag = religious_civil_war }
		NOT = { has_country_flag = religious_turmoil_catholic }
		NOT = { has_country_flag = religious_turmoil_hussite }
		OR = {
			has_country_flag = hussite_wars_second_phase
			check_variable = { which = crusades_fought value = 3 }
		}
		NOT = { has_country_flag = hussite_compacta }
		NOT = { is_religion_enabled = protestant }
	}
	
	mean_time_to_happen = { months = 10 }
	
	immediate = { set_country_flag = hussite_compacta }
	
	option = {
		name = dg_hussite.033.a #Sign the Compact of $CAPITAL_CITY$
		ai_chance = { factor = 90 }
		if = {
			limit = { has_country_flag = hussite_war_ruler }
			set_ruler = hussite_war_ruler
			clr_country_flag = hussite_war_ruler
		}
		if = {
			limit = { has_country_flag = hussite_war_heir }
			set_heir = hussite_war_heir
			clr_country_flag = hussite_war_heir
		}
		add_stability_1 = yes
		add_war_exhaustion = -1
		add_country_modifier = { name = edict_of_tolerance duration = -1 }
		PAP = {
			add_opinion = { who = ROOT modifier = disobeyed_religious_leader }
			hidden_effect = { set_country_flag = hussite_compacta_signed }
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = -4
			add_legitimacy = -4
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = -3
			add_legitimacy = -3
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = -2
			add_legitimacy = -2
		}
		else = {
			add_prestige = -1
			add_legitimacy = -1
		}
		#Allows for later apostasy
		hidden_effect = {
			set_country_flag = was_hussite
			change_variable = { which = sympathy_to_old_religion value = 60 }
		}
	}
	option = {
		name = dg_hussite.033.b #Refuse to compromise with the rebels
		ai_chance = {
			factor = 10
			modifier = {
				NOT = { religious_unity = 0.80 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.60 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.40 }
				factor = 0.7
			}
			modifier = {
				NOT = { religious_unity = 0.20 }
				factor = 0
			}
		}
		if = {
			limit = {
				NOT = { has_country_modifier = religious_tolerance }
				NOT = { has_country_modifier = religious_intolerance }
			}
			add_piety = 0.20
			add_country_modifier = { name = religious_intolerance duration = 1000 }
		}
		if = {
			limit = { has_country_modifier = religious_tolerance }
			add_piety = 0.40
			remove_country_modifier = religious_tolerance
			add_country_modifier = { name = religious_intolerance duration = 1000 }
		}
	}
}

################
# Later Events # 50s
################

country_event = { #Compact with Heresy (1462)
	
	id = dg_hussite.051
	title = dg_hussite.051.t
	desc = dg_hussite.051.d
	picture = catholic_heresy
	
	trigger = {
		is_papal_controller = yes
		PAP = {
			has_country_flag = hussite_compacta_signed
			NOT = { has_country_flag = hussite_compacta_upheld }
			NOT = { has_country_flag = hussite_compacta_considered }
			NOT = { has_country_flag = hussite_compacta_upheld_once }
			NOT = { has_country_flag = hussite_compacta_voided }
		}
		has_global_flag = living_pope
		any_known_country = {
			has_country_flag = hussite_compacta
			OR = {
				NOT = { check_variable = { which = sympathy_to_old_religion value = 1 } }
				NOT = { religion = catholic }
			}
		}
	}
	
	mean_time_to_happen = {
		
		years = 8
		
		modifier = {
			has_country_flag = patriarch_theologian
			factor = 2
		}
		modifier = {
			has_country_flag = patriarch_controversial
			factor = 0.7
		}
		modifier = {
			has_country_flag = patriarch_zealous
			factor = 0.5
		}
		modifier = {
			any_ally = {
				has_country_flag = hussite_compacta
			}
			factor = 1.4
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				marriage_with = ROOT
			}
			factor = 1.4
		}
		modifier = {
			any_rival_country = {
				has_country_flag = hussite_compacta
			}
			factor = 0.7
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				is_enemy = ROOT
			}
			factor = 0.7
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				has_country_flag = friend_of_pope
			}
			factor = 1.4
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				has_country_flag = ally_of_pope
			}
			factor = 2
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				has_country_flag = rival_of_pope
			}
			factor = 0.7
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				has_country_flag = enemy_of_pope
			}
			factor = 0.5
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				NOT = { religion = catholic }
			}
			factor = 0.25
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				war_with = ROOT
			}
			factor = 0.5
		}
		modifier = {
			any_known_country = {
				has_country_flag = hussite_compacta
				truce_with = ROOT
			}
			factor = 0.7
		}
	}
	
	option = {
		name = dg_hussite.051.a #Uphold the compacta
		ai_chance = {
			factor = 25
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					NOT = { religion = catholic }
				}
				factor = 0
			}
			modifier = {
				any_ally = {
					has_country_flag = hussite_compacta
				}
				factor = 1.4
			}
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					marriage_with = ROOT
				}
				factor = 1.4
			}
			modifier = {
				any_subject_country = {
					has_country_flag = hussite_compacta
				}
				factor = 1.4
			}
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					has_country_flag = ally_of_pope
				}
				factor = 2
			}
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					has_country_flag = friend_of_pope
				}
				factor = 1.4
			}
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					has_country_flag = rival_of_pope
				}
				factor = 0.7
			}
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					has_country_flag = enemy_of_pope
				}
				factor = 0.5
			}
			modifier = {
				any_rival_country = {
					has_country_flag = hussite_compacta
				}
				factor = 0.7
			}
			modifier = {
				any_enemy_country = {
					has_country_flag = hussite_compacta
				}
				factor = 0.5
			}
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					truce_with = ROOT
				}
				factor = 0.7
			}
			modifier = {
				any_known_country = {
					has_country_flag = hussite_compacta
					war_with = ROOT
				}
				factor = 0.5
			}
		}
		random_known_country = {
			limit = { has_country_flag = hussite_compacta }
			add_opinion = { who = ROOT modifier = papacy_great }
			add_opinion = { who = PAP modifier = papacy_great }
		}
		add_papal_influence = -5
		if = {
			limit = { PAP = { has_country_flag = hussite_compacta_upheld_once } }
			hidden_effect = {
				PAP = { set_country_flag = hussite_compacta_upheld }
				PAP = { clr_country_flag = hussite_compacta_upheld_once }
			}
			random_known_country = {
				limit = { has_country_flag = hussite_compacta }
				add_stability_1 = yes
			}
		}
		hidden_effect = {
			PAP = { set_country_flag = hussite_compacta_considered }
			PAP = { set_country_flag = hussite_compacta_upheld_once }
		}
	}
	
	option = {
		name = dg_hussite.051.b #Tear up the compacta
		ai_chance = {
			factor = 75
			modifier = {
				has_country_flag = hussite_compacta
				factor = 0
			}
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = 4
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 3
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 2
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 1
		}
		hidden_effect = { PAP = { set_country_flag = hussite_compacta_voided } }
		random_known_country = {
			limit = { has_country_flag = hussite_compacta }
			add_opinion = { who = ROOT modifier = papacy_bad }
			add_opinion = { who = PAP modifier = papacy_bad }
		}
		if = { #Invention of the printing press in 1450 allows for much faster and cheaper communication of problems
			limit = { has_casual_literacy_trigger = yes }
			hidden_effect = {
				if = {
					limit = { NOT = { is_religion_enabled = protestant } }
					PAP = { change_variable = { which = reform_desire_hussites value = 2 } }
				}
			}
			add_reform_desire = 0.02
		}
		else = {
			hidden_effect = {
				if = {
					limit = { NOT = { is_religion_enabled = protestant } }
					PAP = { change_variable = { which = reform_desire_hussites value = 0.5 } }
				}
			}
			add_reform_desire = 0.005
		}
	}
}

country_event = { #Compacta Voided (1471)
	
	id = dg_hussite.052
	title = dg_hussite.052.t
	desc = dg_hussite.052.d
	picture = catholic_heresy
	
	trigger = {
		has_country_flag = hussite_compacta
		PAP = { has_country_flag = hussite_compacta_voided }
		religion = catholic
		NOT = { has_country_flag = hussite_compacta_considered }
		NOT = { has_country_flag = hussite_compacta_torn_up }
		OR = { has_regency = no has_consort_regency = yes }
		is_papal_controller = no
	}
	
	mean_time_to_happen = { months = 10 }
	
	option = {
		name = dg_hussite.052.a #Uphold the compacta
		ai_chance = { factor = 40 }
		hidden_effect = { set_country_flag = hussite_compacta_considered }
		reverse_add_opinion = { who = PAP modifier = disobeyed_religious_leader }
		if = {
			limit = { piety = 0.60 }
			add_legitimacy = -8
		}
		else_if = {
			limit = { piety = 0.20 }
			add_legitimacy = -6
		}
		else_if = {
			limit = { piety = -0.20 }
			add_legitimacy = -4
		}
		else_if = {
			limit = { piety = -0.60 }
			add_legitimacy = -2
		}
	}
	option = {
		name = dg_hussite.052.b #Tear up the compacta
		ai_chance = {
			factor = 60
			modifier = {
				dominant_religion = hussite
				factor = 0
			}
			modifier = {
				check_variable = { which = hussite_population value = 3 }
				factor = 0.7
			}
			modifier = {
				check_variable = { which = hussite_population value = 1 }
				factor = 0.7
			}
			modifier = {
				NOT = { stability = 0 }
				factor = 0.7
			}
			modifier = {
				is_at_war = yes
				factor = 0.7
			}
			modifier = {
				num_of_rebel_controlled_provinces = 1
				factor = 0.7
			}
			modifier = {
				has_country_modifier = edict_of_tolerance
				factor = 0.7
			}
		}
		hidden_effect = { set_country_flag = hussite_compacta_torn_up }
		if = {
			limit = { has_country_modifier = edict_of_tolerance }
			remove_country_modifier = edict_of_tolerance
			hidden_effect = { clr_country_flag = edict_of_tolerance }
			subtract_stability_1 = yes
		}
		if = {
			limit = { any_owned_province = { religion = hussite } }
			every_owned_province = {
				limit = { religion = hussite }
				hidden_effect = {
					set_variable = { which = added_unrest value = 5 }
					add_base_unrest = yes
				}
				custom_tooltip = added_unrest_5
			}
		}
		every_owned_province = {
			limit = {
				NOT = { religion = hussite }
				check_variable = { which = hussite value = 2 }
			}
			hidden_effect = {
				set_variable = { which = added_unrest value = 2 }
				add_base_unrest = yes
			}
			custom_tooltip = added_unrest_2
		}
	}
}

country_event = { #Long-lost brethren
	
	id = dg_hussite.053
	title = dg_hussite.053.t
	desc = dg_hussite.053.d
	picture = protestant_celebration
	
	trigger = {
		any_owned_province = { check_variable = { which = hussite value = 2 } }
		is_religion_enabled = reformed
		NOT = { religion = hussite }
		NOT = { any_known_country = { religion = hussite } }
		NOT = { has_country_flag = hussite_conversion }
	}
	
	mean_time_to_happen = { years = 83 }
	
	
	immediate = { set_country_flag = hussite_conversion }
	
	option = {
		name = dg_hussite.053.a #Encourage the Hussites to join the Protestants
		trigger = {
			OR = {
				religion = protestant
				ai = no
			}
		}
		hidden_effect = {
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 20 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 3 }
				change_variable = { which = reformed value = 1 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 16 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 3 }
				change_variable = { which = reformed value = 1 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 12 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 3 }
				change_variable = { which = reformed value = 1 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 8 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 3 }
				change_variable = { which = reformed value = 1 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 4 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 3 }
				change_variable = { which = reformed value = 1 }
			}
		}
	}
	option = {
		name = dg_hussite.053.b #Encourage the Hussites to join the Reformed Church
		trigger = {
			OR = {
				religion = reformed
				ai = no
			}
		}
		hidden_effect = {
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 20 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 2 }
				change_variable = { which = reformed value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 16 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 2 }
				change_variable = { which = reformed value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 12 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 2 }
				change_variable = { which = reformed value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 8 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 2 }
				change_variable = { which = reformed value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 4 } }
				change_variable = { which = hussite value = -4 }
				change_variable = { which = protestant value = 2 }
				change_variable = { which = reformed value = 2 }
			}
		}
	}
	option = {
		name = dg_hussite.053.c #Encourage the Hussites to remain independent
		trigger = {
			OR = {
				AND = {
					NOT = { religion = protestant }
					NOT = { religion = reformed }
				}
				ai = no
			}
		}
		hidden_effect = {
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 20 } }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = protestant value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 16 } }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = protestant value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 12 } }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = protestant value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 8 } }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = protestant value = 2 }
			}
			every_owned_province = {
				limit = { check_variable = { which = hussite value = 4 } }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = hussite value = -2 }
				change_variable = { which = protestant value = 2 }
			}
		}
	}
}

country_event = { #Calixtine Factions
	
	id = dg_hussite.054
	title = dg_hussite.054.t
	desc = dg_hussite.054.d
	picture = hussite_barons
	
	is_triggered_only = yes #Upon new ruler
	
	immediate = {
		if = {
			limit = {
				OR = {
					any_owned_province = { has_province_flag = lollard_origins }
					has_country_flag = lollard_faction
					overlord = { has_country_flag = lollard_faction }
					AND = {
						NOT = { is_religion_enabled = hussite }
						NOT = { any_owned_province = { has_province_flag = hussite_origins } }
					}
				}
				OR = {
					advisor = theologian
					has_country_flag = lollard_faction
					overlord = { has_country_flag = lollard_faction }
					AND = {
						NOT = { is_religion_enabled = hussite }
						NOT = { any_owned_province = { has_province_flag = hussite_origins } }
					}
				}
			}
			custom_tooltip = lollard_faction
		}
		if = {
			limit = {
				OR = {
					is_religion_enabled = hussite
					any_owned_province = { has_province_flag = hussite_origins }
					has_country_flag = utraquist_faction
					overlord = { has_country_flag = utraquist_faction }
				}
				OR = {
					advisor = theologian
					has_country_flag = utraquist_faction
					overlord = { has_country_flag = utraquist_faction }
				}
			}
			custom_tooltip = utraquist_faction
		}
		if = {
			limit = {
				OR = {
					is_religion_enabled = hussite
					any_owned_province = { has_province_flag = hussite_origins }
					has_country_flag = taborite_faction
					overlord = { has_country_flag = taborite_faction }
				}
				OR = {
					advisor = theologian
					has_country_flag = taborite_faction
					overlord = { has_country_flag = taborite_faction }
				}
			}
			custom_tooltip = taborite_faction
		}
		#TEMP fix
		remove_country_modifier = utraquist
		remove_country_modifier = taborite
		remove_country_modifier = lollard
	}
	
	option = {
		name = dg_hussite.054.a #Lollards
		ai_chance = {
			factor = 30
			modifier = {
				has_country_flag = lollard_faction
				factor = 2
			}
			modifier = {
				any_owned_province = { has_province_flag = lollard_origins has_owner_culture = yes }
				factor = 2
			}
			modifier = {
				has_country_flag = lollard_faction
				government = monarchy
				NOT = { legitimacy = 100 }
				factor = 1.4
			}
			modifier = {
				has_country_flag = lollard_faction
				has_country_flag = patriarch_hostile
				factor = 0.1
			}
			modifier = {
				has_country_flag = lollard_faction
				has_country_flag = patriarch_corrupt
				factor = 0.2
			}
			modifier = {
				has_country_flag = lollard_faction
				has_country_flag = patriarch_controversial
				factor = 0.5
			}
		}
		trigger = {
			OR = {
				any_owned_province = { has_province_flag = lollard_origins }
				has_country_flag = lollard_faction
				overlord = { has_country_flag = lollard_faction }
				AND = {
					NOT = { is_religion_enabled = hussite }
					NOT = { any_owned_province = { has_province_flag = hussite_origins } }
				}
			}
			OR = {
				advisor = theologian
				has_country_flag = lollard_faction
				overlord = { has_country_flag = lollard_faction }
				AND = {
					NOT = { is_religion_enabled = hussite }
					NOT = { any_owned_province = { has_province_flag = hussite_origins } }
				}
			}
		}
		#Normal
		if = {
			limit = {
				has_country_flag = lollard_faction
				piety = 0.6
			}
			add_legitimacy = 3
		}
		if = {
			limit = {
				has_country_flag = lollard_faction
				piety = 0.2
				NOT = { piety = 0.6 }
			}
			add_legitimacy = 2
		}
		if = {
			limit = {
				has_country_flag = lollard_faction
				piety = -0.2
				NOT = { piety = 0.2 }
			}
			add_legitimacy = 1
		}
		set_country_flag = lollard_faction
		add_ruler_modifier = { name = lollard duration = -1 }
		if = {
			limit = {
				OR = {
					has_country_flag = taborite_faction
					has_country_flag = utraquist_faction
				}
			}
			add_adm_power = -25
			clr_country_flag = taborite_faction
			clr_country_flag = utraquist_faction
			clr_country_flag = clerical_advisor
			clr_country_flag = patriarch_zealous
			clr_country_flag = patriarch_theologian
			clr_country_flag = patriarch_obedient
			clr_country_flag = patriarch_controversial
			clr_country_flag = patriarch_corrupt
			clr_country_flag = patriarch_hostile
			clr_country_flag = patriarch_appointed
			if = {
				limit = { piety = 0.60 }
				add_legitimacy = -6
			}
			else_if = {
				limit = { piety = 0.20 }
				add_legitimacy = -4
			}
			else_if = {
				limit = { piety = -0.20 }
				add_legitimacy = -2
			}
		}
	}
	option = {
		name = dg_hussite.054.b #Utraquists
		ai_chance = {
			factor = 40
			modifier = {
				has_country_flag = utraquist_faction
				factor = 2
			}
			modifier = {
				NOT = { legitimacy = 95 }
				government = monarchy
				factor = 1.4
			}
			modifier = {
				has_country_flag = utraquist_faction
				government = monarchy
				NOT = { legitimacy = 100 }
				factor = 1.4
			}
			modifier = {
				has_country_flag = utraquist_faction
				has_country_flag = patriarch_hostile
				factor = 0.1
			}
			modifier = {
				has_country_flag = utraquist_faction
				has_country_flag = patriarch_corrupt
				factor = 0.2
			}
			modifier = {
				has_country_flag = utraquist_faction
				has_country_flag = patriarch_controversial
				factor = 0.5
			}
		}
		trigger = {
			OR = {
				is_religion_enabled = hussite
				any_owned_province = { has_province_flag = hussite_origins }
				has_country_flag = utraquist_faction
				overlord = { has_country_flag = utraquist_faction }
			}
			OR = {
				advisor = theologian
				has_country_flag = utraquist_faction
				overlord = { has_country_flag = utraquist_faction }
			}
		}
		if = {
			limit = {
				has_country_flag = utraquist_faction
				piety = 0.6
			}
			add_legitimacy = 3
		}
		if = {
			limit = {
				has_country_flag = utraquist_faction
				piety = 0.2
				NOT = { piety = 0.6 }
			}
			add_legitimacy = 2
		}
		if = {
			limit = {
				has_country_flag = utraquist_faction
				piety = -0.2
				NOT = { piety = 0.2 }
			}
			add_legitimacy = 1
		}
		set_country_flag = utraquist_faction
		add_ruler_modifier = { name = utraquist duration = -1 }
		if = {
			limit = {
				OR = {
					has_country_flag = lollard_faction
					has_country_flag = taborite_faction
				}
			}
			add_adm_power = -25
			clr_country_flag = lollard_faction
			clr_country_flag = taborite_faction
			clr_country_flag = clerical_advisor
			clr_country_flag = patriarch_zealous
			clr_country_flag = patriarch_theologian
			clr_country_flag = patriarch_obedient
			clr_country_flag = patriarch_controversial
			clr_country_flag = patriarch_corrupt
			clr_country_flag = patriarch_hostile
			clr_country_flag = patriarch_appointed
			if = {
				limit = { piety = 0.60 }
				add_legitimacy = -6
			}
			else_if = {
				limit = { piety = 0.20 }
				add_legitimacy = -4
			}
			else_if = {
				limit = { piety = -0.20 }
				add_legitimacy = -2
			}
		}
	}
	option = {
		name = dg_hussite.054.c #Taborites
		ai_chance = {
			factor = 20
			modifier = {
				has_country_flag = taborite_faction
				factor = 2
			}
			modifier = {
				NOT = { legitimacy = 95 }
				government = monarchy
				factor = 0.7
			}
			modifier = {
				government = republic
				factor = 2
			}
			modifier = {
				vassal = 1
				factor = 0.7
			}
			modifier = {
				NOT = { stability = 1 }
				factor = 0.7
			}
			modifier = {
				num_of_rebel_controlled_provinces = 1
				factor = 0.7
			}
			modifier = {
				is_at_war = yes
				factor = 1.4
			}
			modifier = {
				num_of_loans = 1
				factor = 0.7
			}
			modifier = {
				NOT = { manpower_percentage = 0.50 }
				factor = 1.4
			}
			modifier = {
				has_country_flag = taborite_faction
				government = monarchy
				NOT = { legitimacy = 100 }
				factor = 1.4
			}
			modifier = {
				has_country_flag = taborite_faction
				has_country_flag = patriarch_hostile
				factor = 0.1
			}
			modifier = {
				has_country_flag = taborite_faction
				has_country_flag = patriarch_corrupt
				factor = 0.2
			}
			modifier = {
				has_country_flag = taborite_faction
				has_country_flag = patriarch_controversial
				factor = 0.5
			}
		}
		trigger = {
			OR = {
				is_religion_enabled = hussite
				any_owned_province = { has_province_flag = hussite_origins }
				has_country_flag = taborite_faction
				overlord = { has_country_flag = taborite_faction }
			}
			OR = {
				advisor = theologian
				has_country_flag = taborite_faction
				overlord = { has_country_flag = taborite_faction }
			}
		}
		if = {
			limit = {
				has_country_flag = taborite_faction
				piety = 0.6
			}
			add_legitimacy = 3
		}
		if = {
			limit = {
				has_country_flag = taborite_faction
				piety = 0.2
				NOT = { piety = 0.6 }
			}
			add_legitimacy = 2
		}
		if = {
			limit = {
				has_country_flag = taborite_faction
				piety = -0.2
				NOT = { piety = 0.2 }
			}
			add_legitimacy = 1
		}
		set_country_flag = taborite_faction
		add_ruler_modifier = { name = taborite duration = -1 }
		if = {
			limit = {
				OR = {
					has_country_flag = lollard_faction
					has_country_flag = utraquist_faction
				}
			}
			add_adm_power = -25
			clr_country_flag = lollard_faction
			clr_country_flag = utraquist_faction
			clr_country_flag = clerical_advisor
			clr_country_flag = patriarch_zealous
			clr_country_flag = patriarch_theologian
			clr_country_flag = patriarch_obedient
			clr_country_flag = patriarch_controversial
			clr_country_flag = patriarch_corrupt
			clr_country_flag = patriarch_hostile
			clr_country_flag = patriarch_appointed
			if = {
				limit = { piety = 0.60 }
				add_legitimacy = -6
			}
			else_if = {
				limit = { piety = 0.20 }
				add_legitimacy = -4
			}
			else_if = {
				limit = { piety = -0.20 }
				add_legitimacy = -2
			}
		}
	}
	option = {
		name = dg_hussite.054.e #Play the factions against each other
		ai_chance = { factor = 10 }
		trigger = {
			OR = {
				ADM = 3
				AND = {
					NOT = { has_country_flag = taborite_faction }
					NOT = { has_country_flag = utraquist_faction }
					NOT = { has_country_flag = lollard_faction }
				}
			}
		}
		clr_country_flag = lollard_faction
		clr_country_flag = utraquist_faction
		clr_country_flag = taborite_faction
	}
	after = {
		dg_patriarch_triggers = yes
	}
}
